/*!
 * Consistent.js 0.6.3
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
!function(e,t){var n=e.Consistent=function(){var e=arguments[0];if(e!==t){if(n.isScope(e)){if(arguments[1]!==t){return n.createScope(e,arguments[1])}else{return n.createScope(e,null)}}else if(e.nodeName!==t){return n.findScopeForNode(e)}else if(typeof e==="object"){return n.createScope(null,e)}else{throw new C("Unexpected argument to Consistent(): "+e)}}else{return n.createScope(null,null)}};var i={};var r="ConsistentScope";var a=function(){var e={};var t=document.createElement("div");t.setAttribute("className","test");e.badGetSetAttribute=t.className==="test";e.needChangeEventForActiveOnSubmit=e.needAggressiveChangeHandlingOnInputElements=!!document.createEventObject;return e}();p(n,{settings:{attributes:{key:["data-ct","ct"],show:["data-ct-show","ct-show"],hide:["data-ct-hide","ct-hide"],enabled:["data-ct-enabled","ct-enabled"],disabled:["data-ct-disabled","ct-disabled"],readOnly:["data-ct-readonly","ct-readonly"],readWrite:["data-ct-readwrite","ct-readwrite"],options:["data-ct-options","ct-options"],template:["data-ct-tmpl","ct-tmpl"],templateId:["data-ct-tmpl-id","ct-tmpl-id"],attributes:["data-ct-attrs","ct-attrs"],attributePrefix:["data-ct-attr-","ct-attr-"],properties:["data-ct-props","ct-props"],propertyPrefix:["data-ct-prop-","ct-prop-"],templateAttributePrefix:["data-ct-tmpl-attr-","ct-tmpl-attr-"],templateIdAttributePrefix:["data-ct-tmpl-id-attr-","ct-tmpl-id-attr-"],on:["data-ct-on","ct-on",,"data-ct-bind","ct-bind"],onPrefix:["data-ct-on-","ct-on-",,"data-ct-bind-","ct-bind-"],repeat:["data-ct-repeat","ct-repeat"],repeatContainerId:["data-ct-repeat-container-id","ct-repeat-container-id"],warningPrefix:["data-ct-","ct-"]},scopeIdKey:"__ConsistentScopeID",functionIdKey:"__ConsistentFunctionID",oldDisplayKey:"__ConsistentOldDisplay",maxWatcherLoops:100},isScope:function(e){return e!==t&&e.$!==t&&e.$._type===r},createScope:function(e,t){t=u({},n.defaultOptions,t);var r=new x(e,t);i[r._id]=r._scope;return r._scope},findScopeForNode:function(e){var t=e[n.settings.scopeIdKey];if(t&&i[t]){return i[t]}else{return null}},merge:p});var s={};function o(e){return s.toString.call(e)==="[object Array]"}function l(e){for(var t in e){return false}return true}function f(e,n,i){if(typeof e.indexOf==="function"){return e.indexOf(n,i)}else{if(i===t){i=0}if(i<0){i+=e.length;if(i<0){i=0}}for(var r=i;r<e.length;r++){if(e[r]===n){return r}}return-1}}function p(){var e=[];var n=[];function i(){var r=0;var a=false;if(typeof arguments[0]==="boolean"){a=arguments[0];r++}var s=arguments[r];if(typeof s!=="object"&&typeof s!=="function"){throw new C("Target object argument to merge is not appropriate: "+typeof s)}if(s===null){throw new C("Target object argument to merge is not appropriate: "+s)}for(var l=r+1;l<arguments.length;l++){var p=arguments[l];if(p===t){continue}if(typeof p!=="object"&&typeof p!=="function"){throw new C("Argument "+(l+1)+" to merge is not appropriate: "+typeof p)}e.push(p);n.push(s);for(var u in p){if(u==="$"){continue}var c=p[u];if(c!==t){if(a&&typeof c==="object"&&c!==null){var d=f(e,c);if(d===-1){var h=s[u];if(h===t){h=o(c)?[]:{}}c=i(true,h,c)}else{c=n[d]}}s[u]=c}}}return s}return i.apply(this,arguments)}function u(){var e=[];for(var t=0;t<arguments.length;t++){var n=arguments[t];if(n){e.push(arguments[t].$)}}if(!e[0]){e[0]={}}var i=p.apply(this,arguments);i.$=p.apply(this,e);return i}function c(e){if(!a.badGetSetAttribute){return e}if(e==="class"){return"className"}else{return e}}function d(e,n){var i=n.split(".");var r=e;var a;for(a=0;a<i.length&&r!==t&&r!==null;a++){r=r[i[a]]}if(a===i.length){return r}else{return t}}function h(e,n){if(n===t){n=""}var i=[];for(var r in e){if(typeof e[r]==="object"&&e[r]!==null){i=i.concat(h(e[r],n+r+"."))}else{i.push(n+r)}}return i}function v(e,n,i){var r=n.split(".");var a=e;for(var s=0;s<r.length-1;s++){if(a[r[s]]===t){a[r[s]]={}}a=a[r[s]]}a[r[r.length-1]]=i}function g(e){var t=e.value;if(!t){t=e.text}return t}n.defaultOptions={templateEngine:null,autoListenToChange:true,eventHandlerPrefix:"$",valueFunctionPrefix:"",$:{getNodeOptions:function(e,t){return n.getNodeOptions(e,t)},apply:function(e,n,i){var r,a,s;var o=i.bindings;if(o.selectOptions){a=d(n,o.selectOptions);if(a!==t){var l=e.selectedIndex!==-1?g(e.options[e.selectedIndex]):t;e.length=a.length;for(s=0;s<a.length;s++){var f;if(typeof a[s]==="object"){var p=a[s].text;var u=a[s].value;f=new Option(p!==t?p:"",u!==t?u:"",false,u==l);if(a[s].label!==t){f.label=a[s].label}if(a[s].disabled!==t){f.disabled=!!a[s].disabled}}else{f=new Option(a[s],a[s],false,a[s]==l)}e.options[s]=f}}}if(o.key){a=d(n,o.key);if(a!==t){this.setValue(e,a)}}else if(o.template!==t&&o.template!==null){this.setValue(e,o.template.render(n))}if(o.attributes){var c=o.attributes;for(s=0;s<c.length;s++){if(c[s].key!==t){a=d(n,c[s].key)}else if(c[s].template!==t){a=c[s].template.render(n)}else{a=null}if(a!==t){this.setAttributeValue(e,c[s].name,a)}}}if(o.allAttributes){a=d(n,o.allAttributes);for(r in a){if(a[r]!==t){a=a[r];if(r==="className"){r="class"}this.setAttributeValue(e,r,a)}}}if(o.properties){var v=o.properties;for(s=0;s<v.length;s++){a=d(n,v[s].key);if(a!==t){this.setPropertyValue(e,v[s].name,a)}}}if(o.allProperties){a=d(n,o.allProperties);var y=h(a);for(s=0;s<y.length;s++){var m=d(a,y[s]);if(m!==t){this.setPropertyValue(e,y[s],m)}}}if(o.show){a=d(n,o.show);if(a!==t){if(a){this.show(e)}else{this.hide(e)}}}if(o.hide){a=d(n,o.hide);if(a!==t){if(!a){this.show(e)}else{this.hide(e)}}}if(o.enabled){a=d(n,o.enabled);if(a!==t){this.setPropertyValue(e,"disabled",!a)}}if(o.disabled){a=d(n,o.disabled);if(a!==t){this.setPropertyValue(e,"disabled",!!a)}}if(o.readOnly){a=d(n,o.readOnly);if(a!==t){this.setPropertyValue(e,"readOnly",!!a)}}if(o.readWrite){a=d(n,o.readWrite);if(a!==t){this.setPropertyValue(e,"readOnly",!a)}}},afterApply:function(e,t){},setValue:function(e,t){var n=e.nodeName;if(n==="INPUT"||n==="TEXTAREA"){if(e.type==="checkbox"){if(o(t)){e.checked=e.defaultChecked=f(t,e.value)!==-1}else if(typeof t==="boolean"){e.checked=e.defaultChecked=t}else{e.checked=e.defaultChecked=t==e.value}}else if(e.type==="radio"){e.checked=e.defaultChecked=t==e.value}else{e.value=t}}else if(n==="SELECT"){if(t===null){t=""}var i;if(o(t)){for(i=0;i<e.options.length;i++){e.options[i].selected=f(t,g(e.options[i]))!==-1}}else{for(i=0;i<e.options.length;i++){if(g(e.options[i])==t){e.selectedIndex=i;return}}e.selectedIndex=-1}}else if(n==="IMG"){e.src=t}else{e.innerHTML=t}},setAttributeValue:function(e,t,n){t=c(t);if(n){e.setAttribute(t,n)}else{e.removeAttribute(t)}},setPropertyValue:function(e,t,n){v(e,t,n)},update:function(e,n,i){var r,a;var s=i.bindings;if(s.key){r=this.getValue(e);if(r!==t){if(e.nodeName==="INPUT"&&e.type==="checkbox"){var l=n.$.get(s.key);if(o(l)){a=f(l,e.value);if(r){if(a===-1){l.push(e.value)}}else{if(a!==-1){l.splice(a,1)}}}else if(e.value!=="on"&&(l===t||l===null)){if(r){n.$.set(s.key,e.value)}}else if(typeof l==="boolean"||e.value==="on"){n.$.set(s.key,r)}else if(r&&l!==e.value){n.$.set(s.key,[l,e.value])}}else{n.$.set(s.key,r)}}}if(s.attributes){var p=s.attributes;for(a=0;a<p.length;a++){if(p[a].key!==t){r=this.getAttributeValue(e,p[a].name);n.$.set(p[a].key,r)}}}if(s.allAttributes){r=n.$.get(s.allAttributes);if(r!==t){for(a in r){r[a]=this.getAttributeValue(e,a)}}}if(s.properties){var u=s.properties;for(a=0;a<u.length;a++){r=this.getPropertyValue(e,u[a].name);n.$.set(u[a].key,r)}}if(s.allProperties){r=n.$.get(s.allProperties);if(r!==t){var c=h(r);for(a=0;a<c.length;a++){v(r,c[a],this.getPropertyValue(e,c[a]))}}}if(s.show){r=this.isShowing(e);n.$.set(s.show,r)}if(s.hide){r=this.isShowing(e);n.$.set(s.hide,!r)}if(s.enabled){r=this.getPropertyValue(e,"disabled");n.$.set(s.enabled,!r)}if(s.disabled){r=this.getPropertyValue(e,"disabled");n.$.set(s.disabled,r)}if(s.readOnly){r=this.getPropertyValue(e,"readOnly");n.$.set(s.readOnly,r)}if(s.readWrite){r=this.getPropertyValue(e,"readOnly");n.$.set(s.readWrite,!r)}},getValue:function(e){var n=e.nodeName;if(n==="INPUT"||n==="TEXTAREA"){if(e.type==="checkbox"){return e.checked}else if(e.type==="radio"){return e.checked?e.value:t}else{return e.value}}else if(n==="SELECT"){if(e.multiple){var i=[];for(var r=0;r<e.options.length;r++){if(e.options[r].selected){i.push(g(e.options[r]))}}return i}else if(e.selectedIndex!==-1){return g(e.options[e.selectedIndex])}else{return t}}else if(n==="IMG"){return e.src}else{return e.innerHTML}},getAttributeValue:function(e,t){t=c(t);return e.getAttribute(t)},getPropertyValue:function(e,t){return d(e,t)},show:function(e){if(e.style.display!=="none"){return}var i=e[n.settings.oldDisplayKey];if(i===t){i=""}e.style.display=i},hide:function(e){if(e.style.display==="none"){return}e[n.settings.oldDisplayKey]=e.style.display;e.style.display="none"},isShowing:function(e){return e.style.display!=="none"},added:function(e){},remove:function(e){e.parentNode.removeChild(e)}}};n.defaultOptions.$.$original=n.defaultOptions.$;n.getNodeOptions=n.defaultGetNodeOptions=function(e,i){var r=u({bindings:{}},i);var a=r.bindings;var s=e.nodeName;if(s==="INPUT"||s==="TEXTAREA"||s==="SELECT"){if(a.key===t){a.key=e.getAttribute("name")}}var l=n.settings;var f=e.attributes;for(var p=0;p<f.length;p++){var c=f[p].name;var d=f[p].value;var h=v(c);if(h){switch(h.name){case"key":{a.key=d;break}case"attributePrefix":{b(h.suffix,d);break}case"attributes":{a.allAttributes=d;break}case"template":{g();a.template=i.templateEngine.compile(d);break}case"templateId":{g();a.template=i.templateEngine.compile(y(d));break}case"templateAttributePrefix":{g();_(h.suffix,i.templateEngine.compile(d));break}case"templateIdAttributePrefix":{g();_(h.suffix,i.templateEngine.compile(y(d)));break}case"propertyPrefix":{w(h.suffix.replace(/-/g,"."),d);break}case"properties":{a.allProperties=d;break}case"on":{S(k(e),d);break}case"onPrefix":{S(h.suffix.toLowerCase(),d);break}case"show":{a.show=d;break}case"hide":{a.hide=d;break}case"repeat":{a.repeat=d;break}case"repeatContainerId":{a.repeatContainerId=d;break}case"enabled":{a.enabled=d;break}case"disabled":{a.disabled=d;break}case"readOnly":{a.readOnly=d;break}case"readWrite":{a.readWrite=d;break}case"options":{a.selectOptions=d;break}case"warningPrefix":{if(console.log!==t){console.log('Warning: Unrecognised Consistent attribute "'+c+'" on '+e.nodeName+" element.")}break}default:{throw new C("Unhandled consistent declaration attribute: "+c)}}}}function v(e){for(var t in l.attributes){var n=l.attributes[t];var i;if(t.lastIndexOf("Prefix")===t.length-"Prefix".length){if(o(n)){for(i=0;i<n.length;i++){if(e.indexOf(n[i])===0){return{name:t,suffix:e.substring(n[i].length)}}}}else if(e.indexOf(n)===0){return{name:t,suffix:e.substring(n.length)}}}else{if(o(n)){for(i=0;i<n.length;i++){if(e===n[i]){return{name:t}}}}else if(e===n){return{name:t}}}}return false}function g(){if(!i.templateEngine){throw new C("templateEngine not configured in options")}}function y(e){var t=document.getElementById(e);if(t!==null){return t.innerHTML}else{throw new C("Template not found with id: "+e)}}function m(){if(a.attributes===t){a.attributes=[]}}function b(e,t){m();a.attributes.push({name:e,key:t})}function _(e,t){m();a.attributes.push({name:e,template:t})}function w(e,n){if(a.properties===t){a.properties=[]}a.properties.push({name:e,key:n})}function S(e,n){if(a.events===t){a.events={}}if(a.events[e]===t){a.events[e]={keys:[]}}a.events[e].keys.push(n)}function k(e){var t=e.nodeName;if(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"){return"change"}else if(t==="FORM"){return"submit"}else{return"click"}}return r};function y(e,n,i){if(i===t){i=[]}if(f(i,e)!==-1){return}i.push(e);var r=n.$.options();var a=r.eventHandlerPrefix;var s=r.valueFunctionPrefix;for(var o in e){if(o.indexOf(a)===0){delete e[o]}else if(typeof e[o]==="function"){if(!s){e[o]=e[o].call(n)}else if(o.indexOf(s)===0){var l;if(b(s)){l=o.substring(s.length);l=l.substring(0,1).toLowerCase()+l.substring(1)}else{l=o.substring(s.length)}e[l]=e[o].call(n);delete e[o]}else{delete e[o]}}else if(typeof e[o]==="object"&&e[o]!==null){y(e[o],n,i)}}}n.defaultEmptyScope={$:{_type:r,_scope:null,_manager:null,index:t,apply:function(e,n){if(typeof e==="function"){n=e;e=t}var i=this._scope();if(n!==t){n.call(i,e)}this._manager().apply(e);return i},applyLater:function(n,i){if(typeof n==="function"){i=n;n=t}var r=this._scope();if(i!==t){i.call(r,n)}e.clearTimeout(this._applyLaterTimeout);this._applyLaterTimeout=e.setTimeout(function(){r.$.apply(n)},0);return r},needsApply:function(){return this._manager().needsApply()},update:function(){this._manager().update();return this._scope()},bind:function(e,t){this._manager().bind(e,t);return this._scope()},unbind:function(e){this._manager().unbind(e);return this._scope()},merge:function(e,n){var i=this._scope();if(typeof e==="boolean"){return p(e,i,n)}else if(n===t){return p(i,e)}else if(o(n)){for(var r=0;r<n.length;r++){v(i,n[r],d(e,n[r]))}return i}else if(typeof n!=="object"){v(i,n,d(e,n));return i}else{throw new C("Invalid keys argument to merge: "+n)}},replace:function(e){return this._manager().replaceScope(e)},clear:function(){var e=this._scope();for(var t in e){if(t!=="$"){delete e[t]}}},snapshot:function(e,n){if(e!==t&&typeof e!=="boolean"){throw new C("Invalid type for includeParents: "+typeof e)}var i=this._scope();var r=p(true,{},i);y(r,n!==t?n:i);if(e!==false&&this.parent()){r=p(this.parent().$.snapshot(false,n!==t?n:i),r)}return r},nodes:function(e){if(e!==t&&typeof e!=="boolean"){throw new C("Invalid type for includeParents: "+typeof e)}var n=this._manager()._domNodes;if(e!==false){var i=this.children();for(var r=0;r<i.length;r++){n=n.concat(i[r].$.nodes())}}return n},roots:function(){return this._manager()._rootDomNodes},parent:function(){var e=this._manager()._parentScopeManager;if(e!==null){return e._scope}else{return null}},children:function(){var e=[];var t=this._manager()._childScopeManagers;for(var n=0;n<t.length;n++){e.push(t[n]._scope)}return e},watch:function(e,t){this._manager().watch(e,t);return this._scope()},unwatch:function(e,t){this._manager().unwatch(e,t);return this._scope()},get:function(e,n){if(n!==t&&typeof n!=="boolean"){throw new C("Invalid type for includeParents: "+typeof n)}var i=d(this._scope(),e);if(i!==t){return i}else if(n!==false&&this.parent()){return this.parent().$.get(e)}else{return t}},set:function(e,n){var i=this._scope();var r=e.split(".");var a=i;for(var s=0;s<r.length-1;s++){var o=a[r[s]];if(o===t){a=a[r[s]]={}}else{a=o}}var l=r[r.length-1];var f=this.options().valueFunctionPrefix;if(typeof a[l]!=="function"){if(f){var p=m(l,f);if(typeof a[p]==="function"){a[p].call(i,n);return i}}a[l]=n}else if(!f){a[l].call(i,n)}else{a[l]=n}return i},getEventHandler:function(e,n){if(n!==t&&typeof n!=="boolean"){throw new C("Invalid type for includeParents: "+typeof n)}var i=this.get(m(e,this.options().eventHandlerPrefix),false);if(i!==t){return i}else if(n!==false&&this.parent()){return this.parent().$.getEventHandler(e)}else{return t}},setEventHandler:function(e,t){e=m(e,this.options().eventHandlerPrefix);return this.set(e,t)},options:function(e){return this._manager().getOptions(e)}}};function m(e,t){if(!t){return e}var n=e.split(".");var i="";for(var r=0;r<n.length-1;r++){i+=n[r]+"."}var a=n[n.length-1];if(b(t)){i+=t+a.substring(0,1).toUpperCase()+a.substring(1)}else{i+=t+a}return i}function b(e){if(!e){return false}var t=e.charAt(e.length-1);return t>="A"&&t<="Z"||t>="a"&&t<="z"}function _(e,n,i,r,a,s){if(i===t){i=""}if(r===t){r=0}if(a===t){a=[]}if(s===t){s=[]}if(f(s,e)!==-1||f(s,n)!==-1){return a}s.push(e);s.push(n);var o;for(o in e){if(e[o]!==n[o]){if(typeof e[o]==="object"&&typeof n[o]==="object"){_(e[o],n[o],i+o+".",r+1,a,s)}else{a.push(i+o)}}}for(o in n){if(e[o]===t){a.push(i+o)}}return a}function w(e,t){var n=typeof e;if(n!==typeof t){return false}if(n==="function"){return e===t}else if(n==="object"){var i=_(e,t);return i.length===0}else{return true}}function S(e,t){for(var n=0;n<t.length;n++){e.removeAttribute(t[n])}}x.prototype=new Object;var k=0;var $=0;var N="$all";function x(e,t){this._id="ConsistentScope"+k;k++;if(e){this._parentScopeManager=e.$._manager();this._parentScopeManager._childScopeManagers.push(this)}else{this._parentScopeManager=null}this._childScopeManagers=[];this._options=t;this._nodes=[];this._domNodes=[];this._repeatNodes=[];this._rootDomNodes=[];this._watchers={};this._nodesDirty=false;this._applying=false;var i=this;this._scope=u({},n.defaultEmptyScope);this._scope.$._manager=function(){return i};this._scope.$._scope=function(){return i._scope};this._cleanScopeSnapshot=this._scope.$.snapshot()}x.prototype.apply=function(e){if(this._applying){return}this._applying=true;if(this._updateCleanScopeAndFireWatchers()||this._nodesDirty){var n=this._nodes.length;var i,r;for(i=0;i<n;i++){var a=this._nodes[i];r=e!==t?u({},a.options,e):a.options;r.$.apply(a.dom,this._cleanScopeSnapshot,r)}n=this._repeatNodes.length;for(i=0;i<n;i++){var s=this._repeatNodes[i];r=e!==t?u({},s.options,e):s.options;this._handleRepeat(s,r,this._cleanScopeSnapshot)}this._nodesDirty=false;if(this._parentScopeManager){this._parentScopeManager._scope.$.apply(e)}var o=e!==t?u({},this._options,e):this._options;o.$.afterApply(this._scope,this._cleanScopeSnapshot)}this._applying=false};x.prototype._handleRepeat=function(e,i,r){var a=i.bindings.repeat;var s;var o=this._scope.$.get(a);var l=d(r,a);if(l===t){return}if(typeof l!=="object"){throw new C('Repeat for key "'+a+'" is not an object in the scope, found '+typeof l)}e.version++;var f=e.version;var p=e.insertBefore;var u=null;var c;for(s=0;s<o.length;s++){var h=o[s];c=b(h);var v=false;if(c===t){var g=_();var y=n(this._scope,this._options);y.$.bind(g);y=y.$.replace(h);c={object:h,domNodes:g,scope:y,version:f};e.items.push(c);v=true}else{c.version=f}S(c.domNodes,p,p.parentNode);if(v){for(var m=0;m<c.domNodes.length;m++){i.$.added(c.domNodes[m])}}c.after=u;u=c.domNodes[c.domNodes.length-1];c.scope.$.index=s;c.scope.$.apply()}for(s=0;s<e.items.length;s++){c=e.items[s];if(c.version!==f){if(c.after){S(c.domNodes,c.after.nextSibling,p.parentNode)}w(c.domNodes,c.scope);e.items.splice(s,1);c.scope.$.index=t;s--}}function b(n){for(var i=0;i<e.items.length;i++){if(e.items[i].object===n){return e.items[i]}}return t}function _(){var t=[];for(var n=0;n<e.domNodes.length;n++){t.push(e.domNodes[n].cloneNode(true))}return t}function w(e,t){for(var n=0;n<e.length;n++){t.$.unbind(e[n]);i.$.remove(e[n])}}function S(e,t,n){for(var i=0;i<e.length;i++){n.insertBefore(e[i],t)}}};x.prototype.update=function(){var e=this._nodes.length;for(var t=0;t<e;t++){var n=this._nodes[t];n.options.$.update(n.dom,this._scope,n.options)}};x.prototype.needsApply=function(){if(this._nodesDirty){return true}return this.isDirty()};x.prototype.isDirty=function(){return _(this._scope.$.snapshot(),this._cleanScopeSnapshot).length!==0};x.prototype._updateCleanScopeAndFireWatchers=function(){var e=false;var t;var i=true;var r=0;var a=this._cleanScopeSnapshot;var s={};while(i){var o=this._scope.$.snapshot();t=[];while(i){i=false;if(r>=n.settings.maxWatcherLoops){throw new C("Too many loops while notifying watchers. There is likely to be an infinite loop caused by watcher functions continously changing the scope. You may otherwise increase Consistent.settings.maxWatcherLoops if this is not the case.")}var l=_(o,a);for(var p=0;p<l.length;p++){var u=l[p];if(f(t,u)===-1){t.push(u)}i|=this._notifyWatchers(u,d(o,u),d(a,u),this._scope,s)}r++}if(t.length>0){i|=this._notifyWatchAlls(t,this._scope,o,a,s);e=true}a=o}if(e){this._cleanScopeSnapshot=this._scope.$.snapshot();return true}else{return false}};x.prototype._notifyWatchers=function(e,i,r,a,s){var o=false;var l=this._watchers[e];if(l!==t){for(var f=0;f<l.length;f++){var p=s[e];if(p===t){s[e]=p={}}var u=l[f];var c=u[n.settings.functionIdKey];if(c===t){c=u[n.settings.functionIdKey]="ConsistentFunction"+$;$++}if(p[c]===t||!w(p[c].cleanValue,i)){u.call(a,e,i,r);p[c]={cleanValue:a.$.get(e)};o=true}}}if(this._parentScopeManager){this._parentScopeManager._notifyWatchers(e,i,r,a,s)}return o};x.prototype._notifyWatchAlls=function(e,i,r,a,s){var o=false;var l=this._watchers[N];if(l!==t){for(var f=0;f<l.length;f++){var p=s[N];if(p===t){s[N]=p={}}var u=l[f];var c=u[n.settings.functionIdKey];if(c===t){c=u[n.settings.functionIdKey]="ConsistentFunction"+$;$++}if(p[c]===t||!w(r,p[c].cleanScopeSnapshot)){l[f].call(i,e,r,a);p[c]={cleanScopeSnapshot:i.$.snapshot()};o=true}}}if(this._parentScopeManager){this._parentScopeManager._notifyWatchAlls(e,i,r,a,s)}return o};function E(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}else{throw new C("Unable to attach event to DOM node. Cannot find supported method.")}}function P(e){if(!e.preventDefault){e.preventDefault=function(){this.returnValue=false}}}function A(e,t){var n;if(document.createEvent){n=document.createEvent("HTMLEvents");n.initEvent(t,true,true);e.dispatchEvent(n)}else if(document.createEventObject){e.fireEvent("on"+t)}else{throw new C("Unable to fire a DOM event. Cannot find supported method.")}return n}x.prototype.bind=function(e,i,r){var s;if(o(e)){for(s=0;s<e.length;s++){this.bind(e[s],i,r)}return}var f;if(e[n.settings.scopeIdKey]!==this._id){f=u({},this._options,i);f=f.$.getNodeOptions(e,f);e[n.settings.scopeIdKey]=this._id;if(r===t){this._rootDomNodes.push(e)}if(!l(f.bindings)){if(f.bindings.repeat!==t){var p={version:0,items:[],options:f};var c=f.bindings.repeat;if(f.bindings.repeatContainerId){var d=document.getElementById(f.bindings.repeatContainerId);if(d!==null){p.domNodes=d.children}else{throw new C("Couldn't find element with id \""+f.bindings.repeatContainerId+'" for repeat container.')}}else{p.domNodes=[e.cloneNode(true)]}for(s=0;s<p.domNodes.length;s++){S(p.domNodes[s],n.settings.attributes.repeat);S(p.domNodes[s],n.settings.attributes.repeatContainerId)}var h=document.createComment("Consistent repeat "+c);e.parentNode.insertBefore(h,e);e.parentNode.removeChild(e);h[n.settings.scopeIdKey]=this._id;p.insertBefore=document.createComment("/Consistent repeat "+c);h.parentNode.insertBefore(p.insertBefore,h.nextSibling);this._repeatNodes.push(p);this._nodesDirty=true}else{this._nodes.push({dom:e,options:f});this._domNodes.push(e);this._nodesDirty=true;var v=this;for(var g in f.bindings.events){!function(n,i){var r=function(r){var s;P(r);if(a.needChangeEventForActiveOnSubmit&&n==="submit"&&e.nodeName==="FORM"){for(s=0;s<e.elements.length;s++){if(document.activeElement===e.elements[s]){A(e.elements[s],"change")}}}for(s=0;s<i.length;s++){var o=i[s];var l=v._scope.$.getEventHandler(o);if(l!==t){var f=l.call(e,r,v._scope);if(f===false)break}else{r.preventDefault();l=v._scope.$.get(o);var p=v._options.eventHandlerPrefix;if(typeof l==="function"){throw new C('Bound "'+n+'" event cannot find an event handler function in "'+m(o,p)+'". There is a function in "'+o+'", which is missing the '+p+" prefix and is possibly a mistake?")}else{throw new C('Bound "'+n+'" event cannot find an event handler function in "'+m(o,p)+'"')}}}};f.bindings.events[n].listener=r;E(e,n,r)}(g,f.bindings.events[g].keys)}var y=e.nodeName;if(f.autoListenToChange&&(y==="INPUT"||y==="TEXTAREA"||y==="SELECT")){var b=function(t){P(t);f.$.update(e,v._scope,f);v._scope.$.apply()};E(e,"change",b,false);if(a.needAggressiveChangeHandlingOnInputElements&&y==="INPUT"&&(e.type==="checkbox"||e.type==="radio")){E(e,"click",b,false)}f.$._changeListener=b}}}}if(f===t||!f.bindings.repeat){var _=e.firstChild;while(_!==null){if(_.nodeType===1){this.bind(_,i,e)}_=_.nextSibling}}};x.prototype.unbind=function(e){var n;if(o(e)){for(n=0;n<e.length;n++){this.unbind(e[n])}return}n=f(this._domNodes,e);if(n!==-1){var i=this._nodes[n];var r=i.options;for(var a in r.bindings.events){e.removeEventListener(a,r.bindings.events[a].listener,false)}if(r.$._changeListener!==t){e.removeEventListener("change",r.$._changeListener,false)}this._domNodes.splice(n,1);this._nodes.splice(n,1)}var s=e.firstChild;while(s!==null){if(s.nodeType===1){this.unbind(s)}s=s.nextSibling}};x.prototype.watch=function(e,n){if(typeof e==="function"&&n===t){n=e;e=N}var i=this._watchers[e];if(i===t){i=[];this._watchers[e]=i}i.push(n)};x.prototype.unwatch=function(e,n){if(typeof e==="function"&&n===t){n=e;e=N}var i=this._watchers[e];if(i!==t){var r=f(i,n);i.splice(r,1)}};x.prototype.getOptions=function(e){if(e===t){return this._options}for(var n=0;n<this._nodes.length;n++){if(this._nodes[n].dom===e){return this._nodes[n].options}}return null};x.prototype.replaceScope=function(e){e.$=this._scope.$;this._scope=e;return e};C.prototype=new Object;function C(e){this._message=e}C.prototype.toString=function(){return"Consistent.js exception: "+this._message}}(window);