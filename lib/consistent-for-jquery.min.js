/*! 
 * Consistent.js 0.3.2
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
!function(e,t){var i=e.Consistent=function(){var e=arguments[0];if(e!==t){if(i.isScope(e)){if(arguments[1]!==t){return i.createScope(e,arguments[1])}else{return i.createScope(e,null)}}else if(e.nodeName!==t){return i.findScopeForNode(e)}else if(typeof e==="object"){return i.createScope(null,e)}else{throw new w("Unexpected argument to Consistent(): "+e)}}else{return i.createScope(null,null)}};var n={};var r="ConsistentScope";var a=function(){var e={};var t=document.createElement("div");t.setAttribute("className","test");e.badGetSetAttribute=t.className==="test";return e}();l(i,{settings:{keyDataAttribute:"data-ct",showDataAttribute:"data-ct-show",hideDataAttribute:"data-ct-hide",enabledDataAttribute:"data-ct-enabled",disabledDataAttribute:"data-ct-disabled",readOnlyDataAttribute:"data-ct-readonly",readWriteDataAttribute:"data-ct-readwrite",optionsDataAttribute:"data-ct-options",templateDataAttribute:"data-ct-tmpl",templateIdDataAttribute:"data-ct-tmpl-id",attributesDataAttribute:"data-ct-attrs",attributeDataAttributePrefix:"data-ct-attr-",propertiesDataAttribute:"data-ct-props",propertyDataAttributePrefix:"data-ct-prop-",templateAttributeDataAttributePrefix:"data-ct-tmpl-attr-",templateIdAttributeDataAttributePrefix:"data-ct-tmpl-id-attr-",bindDataAttribute:"data-ct-bind",bindDataAttributePrefix:"data-ct-bind-",repeatDataAttribute:"data-ct-repeat",repeatContainerIdDataAttribute:"data-ct-repeat-container-id",warningDataAttributePrefix:"data-ct-",scopeIdKey:"__ConsistentScopeID",functionIdKey:"__ConsistentFunctionID",oldDisplayKey:"__ConsistentOldDisplay",maxWatcherLoops:100},isScope:function(e){return e!==t&&e.$!==t&&e.$._type===r},createScope:function(e,t){t=f({},i.defaultOptions,t);var r=new A(e,t);n[r._id]=r._scope;return r._scope},findScopeForNode:function(e){var t=e[i.settings.scopeIdKey];if(t&&n[t]){return n[t]}else{return null}},merge:l});var s={};function o(e){return s.toString.call(e)==="[object Array]"}function l(){var e=0;var i=false;if(typeof arguments[0]==="boolean"){i=arguments[0];e++}var n=arguments[e];if(typeof n!=="object"&&typeof n!=="function"){throw new w("First object argument to merge is not appropriate: "+typeof n)}if(n===null){throw new w("First object argument to merge is not appropriate: "+n)}for(var r=e+1;r<arguments.length;r++){var a=arguments[r];if(a===t){continue}if(typeof a!=="object"&&typeof a!=="function"){throw new w("Argument "+(r+1)+" to merge is not appropriate: "+typeof a)}for(var s in a){if(s==="$"){continue}var f=a[s];if(f!==t){if(i&&typeof f==="object"&&f!==null){f=l(true,o(f)?[]:{},f)}n[s]=f}}}return n}function f(){var e=[];for(var t=0;t<arguments.length;t++){var i=arguments[t];if(i){e.push(arguments[t].$)}}if(!e[0]){e[0]={}}var n=l.apply(this,arguments);n.$=l.apply(this,e);return n}function p(e){if(!a.badGetSetAttribute){return e}if(e==="class"){return"className"}else{return e}}function u(e,i){var n=i.split(".");var r=e;var a;for(a=0;a<n.length&&r!==t&&r!==null;a++){r=r[n[a]]}if(a===n.length){return r}else{return t}}function c(e,i){if(i===t){i=""}var n=[];for(var r in e){if(typeof e[r]==="object"&&e[r]!==null){n=n.concat(c(e[r],i+r+"."))}else{n.push(i+r)}}return n}function d(e,i,n){var r=i.split(".");var a=e;for(var s=0;s<r.length-1;s++){if(a[r[s]]===t){a[r[s]]={}}a=a[r[s]]}a[r[r.length-1]]=n}i.defaultOptions={templateEngine:null,autoListenToChange:true,$:{getNodeOptions:function(e,t){return i.getNodeOptions(e,t)},apply:function(e,i,n){var r,a,s;if(n.selectOptions){a=u(i,n.selectOptions);if(a!==t){var o=e.selectedIndex!==-1?e.options[e.selectedIndex].value:t;e.length=a.length;for(s=0;s<a.length;s++){var l;if(typeof a[s]==="object"){var f=a[s].text;var p=a[s].value;l=new Option(f!==t?f:"",p!==t?p:"",false,p==o);if(a[s].label!==t){l.label=a[s].label}if(a[s].disabled!==t){l.disabled=!!a[s].disabled}}else{l=new Option(a[s],a[s],false,a[s]==o)}e.options[s]=l}}}if(n.key){a=u(i,n.key);if(a!==t){this.setValue(e,a)}}else if(n.template!==t&&n.template!==null){this.setValue(e,n.template.render(i))}if(n.attributes){var d=n.attributes;for(s=0;s<d.length;s++){if(d[s].key!==t){a=u(i,d[s].key)}else if(d[s].template!==t){a=d[s].template.render(i)}else{a=null}if(a!==t){this.setAttributeValue(e,d[s].name,a)}}}if(n.allAttributes){a=u(i,n.allAttributes);for(r in a){if(a[r]!==t){this.setAttributeValue(e,r,a[r])}}}if(n.properties){var h=n.properties;for(s=0;s<h.length;s++){a=u(i,h[s].key);if(a!==t){this.setPropertyValue(e,h[s].name,a)}}}if(n.allProperties){a=u(i,n.allProperties);var v=c(a);for(s=0;s<v.length;s++){var g=u(a,v[s]);if(g!==t){this.setPropertyValue(e,v[s],g)}}}if(n.show){a=u(i,n.show);if(a!==t){if(a){this.show(e)}else{this.hide(e)}}}if(n.hide){a=u(i,n.hide);if(a!==t){if(!a){this.show(e)}else{this.hide(e)}}}if(n.enabled){a=u(i,n.enabled);if(a!==t){this.setPropertyValue(e,"disabled",!a)}}if(n.disabled){a=u(i,n.disabled);if(a!==t){this.setPropertyValue(e,"disabled",!!a)}}if(n.readOnly){a=u(i,n.readOnly);if(a!==t){this.setPropertyValue(e,"readOnly",!!a)}}if(n.readWrite){a=u(i,n.readWrite);if(a!==t){this.setPropertyValue(e,"readOnly",!a)}}},afterApply:function(e,t){},setValue:function(e,t){var i=e.nodeName;if(i==="INPUT"||i==="TEXTAREA"){if(e.type==="checkbox"){if(o(t)){e.checked=t.indexOf(e.value)!==-1}else if(typeof t==="boolean"){e.checked=t}else{e.checked=t==e.value}}else if(e.type==="radio"){e.checked=t==e.value}else{e.value=t}}else if(i==="SELECT"){if(t===null){t=""}var n;if(o(t)){for(n=0;n<e.options.length;n++){e.options[n].selected=t.indexOf(e.options[n].value)!==-1}}else{for(n=0;n<e.options.length;n++){if(e.options[n].value==t){e.selectedIndex=n;return}}e.selectedIndex=-1}}else if(i==="IMG"){e.src=t}else{e.innerHTML=t}},setAttributeValue:function(e,t,i){t=p(t);if(i){e.setAttribute(t,i)}else{e.removeAttribute(t)}},setPropertyValue:function(e,t,i){d(e,t,i)},update:function(e,i,n){var r,a;if(n.key){r=this.getValue(e);if(r!==t){if(e.nodeName==="INPUT"&&e.type==="checkbox"){var s=i.$.get(n.key);if(o(s)){a=s.indexOf(e.value);if(r){if(a===-1){s.push(e.value)}}else{if(a!==-1){s.splice(a,1)}}}else if(e.value!=="on"&&(s===t||s===null)){if(r){i.$.set(n.key,e.value)}}else if(typeof s==="boolean"||e.value==="on"){i.$.set(n.key,r)}else if(r&&s!==e.value){i.$.set(n.key,[s,e.value])}}else{i.$.set(n.key,r)}}}if(n.attributes){var l=n.attributes;for(a=0;a<l.length;a++){if(l[a].key!==t){r=this.getAttributeValue(e,l[a].name);i.$.set(l[a].key,r)}}}if(n.allAttributes){r=i.$.get(n.allAttributes);if(r!==t){for(a in r){r[a]=this.getAttributeValue(e,a)}}}if(n.properties){var f=n.properties;for(a=0;a<f.length;a++){r=this.getPropertyValue(e,f[a].name);i.$.set(f[a].key,r)}}if(n.allProperties){r=i.$.get(n.allProperties);if(r!==t){var p=c(r);for(a=0;a<p.length;a++){d(r,p[a],this.getPropertyValue(e,p[a]))}}}if(n.show){r=this.isShowing(e);i.$.set(n.show,r)}if(n.hide){r=this.isShowing(e);i.$.set(n.hide,!r)}if(n.enabled){r=this.getPropertyValue(e,"disabled");i.$.set(n.enabled,!r)}if(n.disabled){r=this.getPropertyValue(e,"disabled");i.$.set(n.disabled,r)}if(n.readOnly){r=this.getPropertyValue(e,"readOnly");i.$.set(n.readOnly,r)}if(n.readWrite){r=this.getPropertyValue(e,"readOnly");i.$.set(n.readWrite,!r)}},getValue:function(e){var i=e.nodeName;if(i==="INPUT"||i==="TEXTAREA"){if(e.type==="checkbox"){return e.checked}else if(e.type==="radio"){return e.checked?e.value:t}else{return e.value}}else if(i==="SELECT"){if(e.multiple){var n=[];for(var r=0;r<e.options.length;r++){if(e.options[r].selected){n.push(e.options[r].value)}}return n}else if(e.selectedIndex!==-1){return e.options[e.selectedIndex].value}else{return t}}else if(i==="IMG"){return e.src}else{return e.innerHTML}},getAttributeValue:function(e,t){t=p(t);return e.getAttribute(t)},getPropertyValue:function(e,t){return u(e,t)},show:function(e){if(e.style.display!=="none"){return}var n=e[i.settings.oldDisplayKey];if(n===t){n=""}e.style.display=n},hide:function(e){if(e.style.display==="none"){return}e[i.settings.oldDisplayKey]=e.style.display;e.style.display="none"},isShowing:function(e){return e.style.display!=="none"},added:function(e){},remove:function(e){e.parentNode.removeChild(e)}}};i.defaultOptions.$.$original=i.defaultOptions.$;i.getNodeOptions=i.defaultGetNodeOptions=function(e,n){var r=f({},n);var a=e.nodeName;if(a==="INPUT"||a==="TEXTAREA"||a==="SELECT"){if(r.key===t){r.key=e.getAttribute("name")}}var s=i.settings;var o=e.attributes;for(var l=0;l<o.length;l++){var p=o[l].name;var u=o[l].value;var c,d,h;if(p===s.keyDataAttribute){r.key=u}else if(p.indexOf(s.attributeDataAttributePrefix)===0){c=p.substring(s.attributeDataAttributePrefix.length);m(c,u)}else if(p===s.attributesDataAttribute){r.allAttributes=u}else if(p===s.templateDataAttribute){v();r.template=n.templateEngine.compile(u)}else if(p===s.templateIdDataAttribute){v();r.template=n.templateEngine.compile(g(u))}else if(p.indexOf(s.templateAttributeDataAttributePrefix)===0){v();c=p.substring(s.templateAttributeDataAttributePrefix.length);b(c,n.templateEngine.compile(u))}else if(p.indexOf(s.templateIdAttributeDataAttributePrefix)===0){v();c=p.substring(s.templateIdAttributeDataAttributePrefix.length);b(c,n.templateEngine.compile(g(u)))}else if(p.indexOf(s.propertyDataAttributePrefix)===0){d=p.substring(s.propertyDataAttributePrefix.length);d=d.replace(/-/g,".");_(d,u)}else if(p===s.propertiesDataAttribute){r.allProperties=u}else if(p===s.bindDataAttribute){h=$(e);A(h,u)}else if(p.indexOf(s.bindDataAttributePrefix)===0){h=p.substring(s.bindDataAttributePrefix.length).toLowerCase();A(h,u)}else if(p===s.showDataAttribute){r.show=u}else if(p===s.hideDataAttribute){r.hide=u}else if(p===s.repeatDataAttribute){r.repeat=u}else if(p===s.repeatContainerIdDataAttribute){r.repeatContainerId=u}else if(p===s.enabledDataAttribute){r.enabled=u}else if(p===s.disabledDataAttribute){r.disabled=u}else if(p===s.readOnlyDataAttribute){r.readOnly=u}else if(p===s.readWriteDataAttribute){r.readWrite=u}else if(p===s.optionsDataAttribute){r.selectOptions=u}else if(p.indexOf(s.warningDataAttributePrefix)===0){if(console.log!==t){console.log('Warning: Unrecognised Consistent attribute "'+p+'" on '+e.nodeName+" element.")}}}function v(){if(!n.templateEngine){throw new w("templateEngine not configured in options")}}function g(e){var t=document.getElementById(e);if(t!==null){return t.innerHTML}else{throw new w("Template not found with id: "+e)}}function y(){if(r.attributes===t){r.attributes=[]}}function m(e,t){y();r.attributes.push({name:e,key:t})}function b(e,t){y();r.attributes.push({name:e,template:t})}function _(e,i){if(r.properties===t){r.properties=[]}r.properties.push({name:e,key:i})}function A(e,i){if(r.events===t){r.events={}}if(r.events[e]===t){r.events[e]={keys:[]}}r.events[e].keys.push(i)}function $(e){var t=e.nodeName;if(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"){return"change"}else if(t==="FORM"){return"submit"}else{return"click"}}return r};function h(e,t){for(var i in e){if(i.indexOf("$")===0){delete e[i]}else if(typeof e[i]==="function"){e[i]=e[i].call(t)}else if(typeof e[i]==="object"&&e[i]!==null){h(e[i],t)}}}i.defaultEmptyScope={$:{_type:r,_scope:null,_manager:null,index:t,apply:function(e,i){if(typeof e==="function"){i=e;e=t}if(i!==t){i.call(this._scope,e)}this._manager.apply(e);return this._scope},applyLater:function(i,n){if(typeof i==="function"){n=i;i=t}if(n!==t){n.call(this._scope,i)}e.clearTimeout(this._scope.$._applyLaterTimeout);var r=this;this._scope.$._applyLaterTimeout=e.setTimeout(function(){r._scope.$.apply(i)},0);return this._scope},needsApply:function(){return this._manager.needsApply()},update:function(){this._manager.update();return this._scope},bind:function(e,t){this._manager.bind(e,t);return this._scope},merge:function(e){return l(this._scope,e)},replace:function(e){return this._manager.replaceScope(e)},clear:function(){for(var e in this._scope){if(e!=="$"){delete this._scope[e]}}},snapshot:function(e){var i=this._scope.$.snapshotLocal(e);if(this.parent()){i=l(this.parent().$.snapshot(e!==t?e:this._scope),i)}return i},snapshotLocal:function(e){var i=l(true,{},this._scope);h(i,e!==t?e:this._scope);return i},nodes:function(){return this._manager._domNodes},roots:function(){return this._manager._rootDomNodes},parent:function(){return this._manager._parentScope},watch:function(e,t){this._manager.watch(e,t);return this._scope},unwatch:function(e,t){this._manager.unwatch(e,t);return this._scope},get:function(e){var i=this.getLocal(e);if(i!==t){return i}else if(this.parent()){return this.parent().$.get(e)}else{return t}},getLocal:function(e,t){var i=u(this._scope,e);if(t&&typeof i==="function"){i=i.call(this._scope)}return i},set:function(e,i){var n=e.split(".");var r=this._scope;for(var a=0;a<n.length-1;a++){var s=r[n[a]];if(s===t){r=r[n[a]]={}}else{r=s}}if(typeof r[n[n.length-1]]!=="function"){r[n[n.length-1]]=i}else{r[n[n.length-1]].call(this._scope,i)}return this._scope},getEventHandler:function(e){var i=this.getLocalEventHandler(e);if(i!==t){return i}else if(this.parent()){return this.parent().$.getEventHandler(e)}else{return t}},getLocalEventHandler:function(e){e=v(e);return this.getLocal(e,false)},setEventHandler:function(e,t){e=v(e);return this.set(e,t)},options:function(e){return this._manager.getOptions(e)}}};function v(e){var t=e.split(".");var i="";for(var n=0;n<t.length-1;n++){i+=t[n]+"."}var r=t[t.length-1];if(r.indexOf("$")!==0){i+="$"+r}else{i+=r}return i}function g(e,i,n,r,a,s){if(n===t){n=""}if(r===t){r=0}if(a===t){a=[]}if(s===t){s=[]}if(s.indexOf(e)!==-1||s.indexOf(i)!==-1){return a}s.push(e);s.push(i);var o;for(o in e){if(e[o]!==i[o]){if(typeof e[o]==="object"&&typeof i[o]==="object"){g(e[o],i[o],n+o+".",r+1,a,s)}else{a.push(n+o)}}}for(o in i){if(e[o]===t){a.push(n+o)}}return a}function y(e){var t=f({},e);t.$._scope=t;return t}A.prototype=new Object;var m=0;var b=0;var _="$all";function A(e,t){this._id="ConsistentScope"+m;m++;this._parentScope=e;this._options=t;this._nodes=[];this._domNodes=[];this._rootDomNodes=[];this._watchers={};this._nodesDirty=false;this._applying=false;this._scope=f({},i.defaultEmptyScope);this._scope.$._manager=this;this._scope.$._scope=this._scope;this._cleanScopeSnapshot=this._scope.$.snapshot()}A.prototype.apply=function(e){if(this._applying){return}this._applying=true;if(this._updateCleanScopeAndFireWatchers()||this._nodesDirty){var i=this._nodes.length;for(var n=0;n<i;n++){var r=this._nodes[n];var a=e!==t?f({},r.options,e):r.options;a.$.apply(r.dom,this._cleanScopeSnapshot,a);if(a.repeat){this._handleRepeat(r,a,this._cleanScopeSnapshot)}}this._nodesDirty=false;if(this._parentScope){this._parentScope.$.apply(e)}var s=e!==t?f({},this._options,e):this._options;s.$.afterApply(this._scope,this._cleanScopeSnapshot)}this._applying=false};A.prototype._handleRepeat=function(e,n,r){var a=n.repeat;var s;var o=e.repeatData;if(o===t){o={version:0,items:[]};if(n.repeatContainerId){var l=document.getElementById(n.repeatContainerId);if(l!==null){o.domNodes=l.children}else{throw new w("Couldn't find element with id \""+n.repeatId+'" for repeat container.')}}else{o.domNodes=[e.dom.cloneNode(true)]}for(s=0;s<o.domNodes.length;s++){o.domNodes[s].removeAttribute(i.settings.repeatDataAttribute);o.domNodes[s].removeAttribute(i.settings.repeatContainerIdDataAttribute)}e.repeatData=o;var f=document.createComment("Consistent repeat "+a);e.dom.parentNode.insertBefore(f,e.dom);e.dom.parentNode.removeChild(e.dom);f[i.settings.scopeIdKey]=this._id;e.dom=f;o.insertBefore=document.createComment("/Consistent repeat "+a);e.dom.parentNode.insertBefore(o.insertBefore,f.nextSibling)}var p=this._scope.$.get(a);var c=u(r,a);if(c===t){return}if(typeof c!=="object"){throw new w('Repeat for key "'+a+'" is not an object in the scope, found '+typeof c)}o.version++;var d=o.version;var h=o.insertBefore;var v=null;var g;for(s=0;s<p.length;s++){var y=p[s];g=$(y);var m=false;if(g===t){var b=D();var _=i(this._scope,this._options);_.$.bind(b);_=_.$.replace(y);g={object:y,domNodes:b,scope:_,version:d};o.items.push(g);m=true}else{g.version=d}x(g.domNodes,h,h.parentNode);if(m){for(var A=0;A<g.domNodes.length;A++){n.$.added(g.domNodes[A])}}g.after=v;v=g.domNodes[g.domNodes.length-1];g.scope.$.index=s;g.scope.$.apply()}for(s=0;s<o.items.length;s++){g=o.items[s];if(g.version!==d){if(g.after){x(g.domNodes,g.after.nextSibling,h.parentNode)}S(g.domNodes);o.items.splice(s,1);g.scope.$.index=t;s--}}function $(e){for(var i=0;i<o.items.length;i++){if(o.items[i].object===e){return o.items[i]}}return t}function D(){var e=[];for(var t=0;t<o.domNodes.length;t++){e.push(o.domNodes[t].cloneNode(true))}return e}function S(e){for(var t=0;t<e.length;t++){n.$.remove(e[t])}}function x(e,t,i){for(var n=0;n<e.length;n++){i.insertBefore(e[n],t)}}};A.prototype.update=function(){var e=this._nodes.length;for(var t=0;t<e;t++){var i=this._nodes[t];i.options.$.update(i.dom,this._scope,i.options)}};A.prototype.needsApply=function(){if(this._nodesDirty){return true}return this.isDirty()};A.prototype.isDirty=function(){return g(this._scope.$.snapshot(),this._cleanScopeSnapshot).length!==0};A.prototype._updateCleanScopeAndFireWatchers=function(){var e=false;var t;var n=true;var r=0;var a=this._cleanScopeSnapshot;var s={};while(n){var o=this._scope.$.snapshot();t=[];while(n){n=false;if(r>=i.settings.maxWatcherLoops){throw new w("Too many loops while notifying watchers. There is likely to be an infinite loop caused by watcher functions continously changing the scope. You may otherwise increase Consistent.settings.maxWatcherLoops if this is not the case.")}var l=g(o,a);for(var f=0;f<l.length;f++){var p=l[f];if(t.indexOf(p)===-1){t.push(p)}n|=this._notifyWatchers(p,u(o,p),u(a,p),this._scope,s)}r++}if(t.length>0){n|=this._notifyWatchAlls(t,this._scope,o,a,s);e=true}a=o}if(e){this._cleanScopeSnapshot=this._scope.$.snapshot();return true}else{return false}};A.prototype._notifyWatchers=function(e,n,r,a,s){var o=false;var l=this._watchers[e];if(l!==t){for(var f=0;f<l.length;f++){var p=s[e];if(p===t){s[e]=p={}}var u=l[f];var c=u[i.settings.functionIdKey];if(c===t){c=u[i.settings.functionIdKey]="ConsistentFunction"+b;b++}if(p[c]===t||p[c].cleanValue!==n){u.call(a,e,n,r);p[c]={cleanValue:a.$.get(e)};o=true}}}if(this._parentScope){this._parentScope.$._manager._notifyWatchers(e,n,r,a,s)}return o};A.prototype._notifyWatchAlls=function(e,n,r,a,s){var o=false;var l=this._watchers[_];if(l!==t){for(var f=0;f<l.length;f++){var p=s[_];if(p===t){s[_]=p={}}var u=l[f];var c=u[i.settings.functionIdKey];if(c===t){c=u[i.settings.functionIdKey]="ConsistentFunction"+b;b++}if(p[c]===t||g(r,p[c].cleanScopeSnapshot).length!==0){l[f].call(n,e,r,a);p[c]={cleanScopeSnapshot:n.$.snapshot()};o=true}}}if(this._parentScope){this._parentScope.$._manager._notifyWatchAlls(e,n,r,a,s)}return o};A.prototype.bind=function(e,n,r){if(o(e)){for(var a=0;a<e.length;a++){this.bind(e[a],n,r)}return}if(e[i.settings.scopeIdKey]!==this._id){var s=f({},this._options,n);s=s.$.getNodeOptions(e,s);this._nodes.push({dom:e,options:s});this._domNodes.push(e);if(r===t){this._rootDomNodes.push(e)}this._nodesDirty=true;e[i.settings.scopeIdKey]=this._id;var l=this;for(var p in s.events){!function(i,n){var r=function(r){for(var a=0;a<n.length;a++){var s=n[a];var o=l._scope.$.getEventHandler(s);if(o!==t){var f=o.call(e,r,l._scope);if(f===false)break}else{r.preventDefault();o=l._scope.$.get(s);if(typeof o==="function"){throw new w('Bound "'+i+'" event wanted scope function in key "'+v(s)+'", there was one in "'+s+'" which is missing the $ and is possibly a mistake.')}else{throw new w('Bound "'+i+'" event wanted scope function in key "'+v(s)+'"')}}}};s.events[i].listener=r;if(e.addEventListener){e.addEventListener(i,r,false)}else if(e.attachEvent){e.attachEvent("on"+i,r)}else{throw new w("Unable to attach event to DOM node. Cannot find supported method.")}}(p,s.events[p].keys)}var u=e.nodeName;if(s.autoListenToChange&&(u==="INPUT"||u==="TEXTAREA"||u==="SELECT")){var c=function(t){s.$.update(e,l._scope,s);l._scope.$.apply()};e.addEventListener("change",c,false);s.$._changeListener=c}}var d=e.firstChild;while(d!==null){if(d.nodeType===1){this.bind(d,n,e)}d=d.nextSibling}};A.prototype.unbind=function(e){var i;if(o(e)){for(i=0;i<e.length;i++){this.unbind(e[i])}return}i=this._domNodes.indexOf(e);if(i!==-1){var n=this._nodes[i];var r=n.options;for(var a in r.events){e.removeEventListener(a,r.events[a].listener,false)}if(r.$._changeListener!==t){e.removeEventListener("change",r.$._changeListener,false)}this._domNodes.slice(i,1);this._nodes.slice(i,1)}var s=e.firstChild;while(s!==null){if(s.nodeType===1){this.unbind(s)}s=s.nextSibling}};A.prototype.nodes=function(){return _domNodes};A.prototype.watch=function(e,i){if(typeof e==="function"&&i===t){i=e;e=_}var n=this._watchers[e];if(n===t){n=[];this._watchers[e]=n}n.push(i)};A.prototype.unwatch=function(e,i){if(typeof e==="function"&&i===t){i=e;e=_}var n=this._watchers[e];if(n!==t){var r=n.indexOf(i);n.splice(r,1)}};A.prototype.getOptions=function(e){for(var t=0;t<this._nodes.length;t++){if(this._nodes[t].dom===e){return this._nodes[t].options}}return null};A.prototype.replaceScope=function(e){e.$=this._scope.$;e.$._scope=e;this._scope=e;return e};w.prototype=new Error;function w(e){this._message=e}w.prototype.toString=function(){return"Consistent.js exception: "+this._message}}(window);if(!("indexOf"in Array.prototype)){Array.prototype.indexOf=function(e,t){if(t===undefined)t=0;if(t<0)t+=this.length;if(t<0)t=0;for(var i=this.length;t<i;t++){if(t in this&&this[t]===e){return t}}return-1}}/*! 
 * Consistent.js jQuery plugin 0.3.2
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
!function(e,t,i){var n=e.consistent=t.Consistent;e.fn.consistent=function(){var e,t;if(arguments.length===0){this.each(function(){var t=n.findScopeForNode(this);if(t){if(e&&e!==t){throw"The given nodes have multiple different scopes"}e=t}else if(e){throw"Some of the given nodes have scopes and others don't"}});if(e){return e}else{e=n()}}else{var i=arguments[0];if(n.isScope(i)){e=i;t=arguments.length>1?arguments[1]:null}else if(typeof i==="object"){e=n(i);t=null}else{throw"First argument to $.consistent was not an appropriate type: "+typeof i}}this.each(function(){e.$.bind(this,t)});return e}}(jQuery,window);