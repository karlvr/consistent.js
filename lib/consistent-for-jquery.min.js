/*!
 * Consistent.js 0.12.6
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
(function(e,t){"use strict";var n=e.document;var r=e.Consistent=function(e){if(arguments.length===0){return r.createScope()}if(typeof e==="string"){return r.findScope(e)}if(e.nodeName!==t){return r.findScopeForNode(e)}var n;var i;var o;var s=0;if(r.isScope(e)){n=e;s++}if(typeof arguments[s]==="object"){i=arguments[s];s++}if(typeof arguments[s]==="function"){o=arguments[s];s++}if(arguments[s]!==t){throw M("Unexpected argument to Consistent(): "+e)}return r.createScope(n,i,o)};var i={};var o={};var s="ConsistentScope";var a=function(){var e={};var t=n.createElement("div");t.setAttribute("className","test");e.badGetSetAttribute=t.className==="test";e.needChangeEventForActiveOnSubmit=e.needAggressiveChangeHandlingOnInputElements=!!n.createEventObject;return e}();p(r,{settings:{attributes:{key:["data-ct","ct"],show:["data-ct-show","ct-show"],hide:["data-ct-hide","ct-hide"],enabled:["data-ct-enabled","ct-enabled"],disabled:["data-ct-disabled","ct-disabled"],readOnly:["data-ct-readonly","ct-readonly"],readWrite:["data-ct-readwrite","ct-readwrite"],options:["data-ct-options","ct-options"],template:["data-ct-tmpl","ct-tmpl"],templateId:["data-ct-tmpl-id","ct-tmpl-id"],attributes:["data-ct-attrs","ct-attrs"],attributePrefix:["data-ct-attr-","ct-attr-"],properties:["data-ct-props","ct-props"],propertyPrefix:["data-ct-prop-","ct-prop-"],templateAttributePrefix:["data-ct-tmpl-attr-","ct-tmpl-attr-"],templateIdAttributePrefix:["data-ct-tmpl-id-attr-","ct-tmpl-id-attr-"],classAttribute:["data-ct-class","ct-class"],classAddAttribute:["data-ct-add-class","ct-add-class"],on:["data-ct-do","ct-do"],onPrefix:["data-ct-on-","ct-on-"],repeat:["data-ct-repeat","ct-repeat"],repeatContainerId:["data-ct-repeat-container-id","ct-repeat-container-id"],noBind:["data-ct-nobind","ct-nobind"],update:["data-ct-update","ct-update"],scope:["data-ct-scope","ct-scope"],init:["data-ct-init","ct-init"],initFunc:["data-ct-init-func","ct-init-func"],controller:["data-ct-controller","ct-controller"],warningPrefix:["data-ct-","ct-"]},scopeIdKey:"__ConsistentScopeID",functionIdKey:"__ConsistentFunctionID",oldDisplayKey:"__ConsistentOldDisplay",addedClassesKey:"__ConsistentAddedClasses",maxWatcherLoops:100,autoCreateScopes:true},isScope:function(e){return e!==t&&e.$!==t&&e.$._type===s},createScope:function(e,t,n){t=d({},r.defaultOptions,t);var s=new V(e,t);i[s._id]=s;if(s._name){o[s._name]=s}var a=s._scope;if(n){if(typeof n==="function"){s.replaceController(new n(a))}else{throw M("Invalid argument type for controller: "+typeof n)}}return a},autoCreateScopes:function(){var t=n;var i=r.settings.attributes.scope;var o=r.settings.attributes.controller;var s=r.settings.attributes.init;var a=r.settings.attributes.initFunc;var l=i.length;var f=o.length;var u=s.length;var c=a.length;p(t);function p(t){var n,d;var h;if(t.hasAttribute){for(h=0;h<l;h++){if(t.hasAttribute(i[h])){n=t.getAttribute(i[h]);break}}for(h=0;h<f;h++){if(t.hasAttribute(o[h])){d=t.getAttribute(o[h]);break}}}if(typeof n==="string"||d){var v;if(d){v=b(e,d);if(!v){throw M("Cannot find controller class: "+d)}}var g=r.createScope(null,n?{name:n}:null,v);g.$.bind(t);var y;for(h=0;h<u;h++){y=t.getAttribute(s[h]);if(y){break}}var m;for(h=0;h<c;h++){var _=t.getAttribute(a[h]);if(_){m=b(e,_);if(typeof m!=="function"){throw M("Consistent scope init function attribute referenced a function that was not found: "+_)}break}}if(!y){if(!m&&!v){g.$.update()}if(m){m.call(g)}g.$.apply()}else if(y==="update"){g.$.update();if(m){m.call(g)}g.$.apply()}else if(y==="none"){if(m){m.call(g)}}else if(y){var w=r.statementToFunction(y);x(w,g);if(m){m.call(g)}g.$.apply()}}else{var $=t.firstChild;while($!==null){if($.nodeType===1){p($)}$=$.nextSibling}}}},destroyScope:function(e){var t=e.$._manager();t.destroy();delete i[t._id];if(t._name){delete o[t._name]}},findScope:function(e){var t=o[e];if(t){return t._scope}else{return null}},findScopeForNode:function(e){var t=e[r.settings.scopeIdKey];if(t&&i[t]){return i[t]._scope}else{return null}},expressionToFunction:function(e){throw M("Expression support requires consistent-expressions.js")},statementToFunction:function(e){throw M("Expression support requires consistent-expressions.js")},merge:p});var l={};function f(e){return l.toString.call(e)==="[object Array]"}function u(e){for(var t in e){return false}return true}var c;if(typeof[].indexOf==="function"){c=function(e,t,n){return e.indexOf(t,n)}}else{c=function(e,n,r){if(r===t){r=0}if(r<0){r+=e.length;if(r<0){r=0}}for(var i=r;i<e.length;i++){if(e[i]===n){return i}}return-1}}r.arrayIndexOf=c;function p(){var e=[];var n=[];function r(){var i=0;var o=false;if(typeof arguments[0]==="boolean"){o=arguments[0];i++}var s=arguments[i];if(typeof s!=="object"&&typeof s!=="function"){throw M("Target object argument to merge is not appropriate: "+typeof s)}if(s===null){throw M("Target object argument to merge is not appropriate: "+s)}for(var a=i+1;a<arguments.length;a++){var l=arguments[a];if(l===t){continue}if(typeof l!=="object"&&typeof l!=="function"){throw M("Argument "+(a+1)+" to merge is not appropriate: "+typeof l)}e.push(l);n.push(s);for(var u in l){var p=l[u];if(p!==t){if(o&&typeof p==="object"&&p!==null){var d=c(e,p);if(d===-1){var h=s[u];if(h===t){h=f(p)?[]:{}}p=r(true,h,p)}else{p=n[d]}}s[u]=p}}}return s}return r.apply(null,arguments)}function d(){var e=[];for(var t=0;t<arguments.length;t++){var n=arguments[t];if(n){e.push(arguments[t].$)}}if(!e[0]){e[0]={}}var r=p.apply(null,arguments);r.$=p.apply(null,e);return r}function h(e){if(!a.badGetSetAttribute){return e}if(e==="class"){return"className"}else{return e}}function v(e){return e.replace(/\.([0-9]+)(\.|$)/g,"[$1]$2")}function g(e){var t=[];for(var n=0;n<e.length;n++){t.push(v(e[n]))}return t}function y(e){return e.replace(/\[([0-9]+)\]/g,".$1")}function b(e,n){var r=n.split(".");var i=e;var o;for(o=0;o<r.length&&i!==t&&i!==null;o++){if(r[o]==="constructor"){throw M("Illegal attempt to access 'constructor' keyword for property: "+n)}if(i&&i.constructor===i){throw M("Illegal attempt to access Function constructor for property: "+n)}i=i[r[o]]}if(o===r.length){if(i&&i.constructor===i){throw M("Illegal attempt to access Function constructor for property: "+n)}return i}else{return t}}function m(e,n){if(n===t){n=""}var r=[];for(var i in e){if(typeof e[i]==="object"&&e[i]!==null){r=r.concat(m(e[i],n+i+"."))}else{r.push(n+i)}}return r}function _(e,n,r){var i=n.split(".");var o=e;for(var s=0;s<i.length-1;s++){if(o[i[s]]===t){o[i[s]]={}}o=o[i[s]]}o[i[i.length-1]]=r}function w(e){var t=e.value;if(t===null){t=e.text}return t}function $(e,t){return e({get:function(e){return b(t,e)}})}function x(e,t){return e({get:function(e){return t.$.get(e)},set:function(e,n){return t.$.set(e,n)}})}r.defaultOptions={templateEngine:null,autoListenToChange:true,autoListenToKeyEvents:true,eventHandlerPrefix:"",valueFunctionPrefix:"",$:{getNodeOptions:function(e,t){return r.getNodeOptions(e,t)},apply:function(e,n,r){var i,o,s;var a=r.bindings;if(a.selectOptions){o=b(n,a.selectOptions);if(o!==t){if(!o){o=[]}var l=this.getValue(e);e.length=o.length;for(s=0;s<o.length;s++){var u;if(typeof o[s]==="object"){var c=o[s].text;var p=o[s].value;u=new Option(c!==t?c:"",p!==t?p:"",false,false);if(o[s].label!==t){u.label=o[s].label}if(o[s].disabled!==t){u.disabled=!!o[s].disabled}}else{u=new Option(o[s],o[s],false,false)}e.options[s]=u}this.setValue(e,l)}}if(a.key){o=y(a.key);if(o!==t){this.setValue(e,o)}}else if(a.template!==t&&a.template!==null){this.setValue(e,a.template.render(n))}if(a.attributes){var d=a.attributes;for(s=0;s<d.length;s++){if(d[s].key!==t){o=y(d[s].key)}else if(d[s].template!==t){o=d[s].template.render(n)}else{o=null}if(o!==t){this.setAttributeValue(e,d[s].name,o)}}}if(a.allAttributes){o=b(n,a.allAttributes);for(i in o){if(o[i]!==t){o=o[i];if(i==="className"){i="class"}this.setAttributeValue(e,i,o)}}}if(a.classAttribute){o=y(a.classAttribute);if(o!==t){if(f(o)){o=o.join(" ")}this.setAttributeValue(e,"class",o)}}if(a.classAddAttribute){o=y(a.classAddAttribute);if(o!==t){this.addRemoveClasses(e,o)}}if(a.properties){var h=a.properties;for(s=0;s<h.length;s++){o=y(h[s].key);if(o!==t){this.setPropertyValue(e,h[s].name,o)}}}if(a.allProperties){o=b(n,a.allProperties);var v=m(o);for(s=0;s<v.length;s++){var g=b(o,v[s]);if(g!==t){this.setPropertyValue(e,v[s],g)}}}if(a.show){o=y(a.show);if(o!==t){if(o){this.show(e)}else{this.hide(e)}}}if(a.hide){o=y(a.hide);if(o!==t){if(!o){this.show(e)}else{this.hide(e)}}}if(a.enabled){o=y(a.enabled);if(o!==t){this.setPropertyValue(e,"disabled",!o)}}if(a.disabled){o=y(a.disabled);if(o!==t){this.setPropertyValue(e,"disabled",!!o)}}if(a.readOnly){o=y(a.readOnly);if(o!==t){this.setPropertyValue(e,"readOnly",!!o)}}if(a.readWrite){o=y(a.readWrite);if(o!==t){this.setPropertyValue(e,"readOnly",!o)}}function y(e){if(typeof e==="function"){return $(e,n)}else{return b(n,e)}}},afterApply:function(e,t){},setValue:function(e,t){var n=this.getValue(e);if(n===t){return}var r=e.nodeName;if(r==="INPUT"||r==="TEXTAREA"){if(e.type==="checkbox"){if(f(t)){e.checked=e.defaultChecked=c(t,e.value)!==-1}else if(typeof t==="boolean"){e.checked=e.defaultChecked=t}else{e.checked=e.defaultChecked=t==e.value}}else if(e.type==="radio"){e.checked=e.defaultChecked=t==e.value}else{if(t===null){t=""}e.value=t}}else if(r==="SELECT"){if(t===null){t=""}var i;if(f(t)){for(i=0;i<e.options.length;i++){e.options[i].selected=c(t,w(e.options[i]))!==-1}}else{for(i=0;i<e.options.length;i++){if(w(e.options[i])==t){e.selectedIndex=i;return}}e.selectedIndex=-1}}else if(r==="IMG"){e.src=t}else{e.innerHTML=t}},setAttributeValue:function(e,t,n){t=h(t);if(n){e.setAttribute(t,n)}else{e.removeAttribute(t)}},setPropertyValue:function(e,t,n){_(e,t,n)},update:function(e,n,r){var i,o;var s=r.bindings;var a=s.update;if(a==="disabled"){return}if(g(s.selectOptions)){var l=e.options;i=[];for(o=0;o<l.length;o++){var u=l[o];i.push({text:u.text,value:u.value,label:u.label,disabled:u.disabled})}n.$.set(s.selectOptions,i)}if(g(s.key)){i=this.getValue(e);if(i!==t){if(e.nodeName==="INPUT"&&e.type==="checkbox"){var p=n.$.get(s.key);if(f(p)){o=c(p,e.value);if(i){if(o===-1){p.push(e.value)}}else{if(o!==-1){p.splice(o,1)}}}else if(e.value!=="on"&&(p===t||p===null)){if(i){n.$.set(s.key,e.value)}}else if(typeof p==="boolean"||e.value==="on"){n.$.set(s.key,i)}else if(i&&p!==e.value){n.$.set(s.key,[p,e.value])}else if(!i&&p===e.value){n.$.set(s.key,t)}}else{n.$.set(s.key,i)}}}if(g(s.attributes)){var d=s.attributes;for(o=0;o<d.length;o++){if(d[o].key!==t){i=this.getAttributeValue(e,d[o].name);n.$.set(d[o].key,i)}}}if(g(s.allAttributes)){i=n.$.get(s.allAttributes);if(i!==t){for(o in i){i[o]=this.getAttributeValue(e,o)}n.$.set(s.allAttributes,i)}}if(g(s.classAttribute)){i=this.getAttributeValue(e,"class");if(f(n.$.get(s.classAttribute))){i=i.split(" ")}n.$.set(s.classAttribute,i)}if(g(s.properties)){var h=s.properties;for(o=0;o<h.length;o++){i=this.getPropertyValue(e,h[o].name);n.$.set(h[o].key,i)}}if(g(s.allProperties)){i=n.$.get(s.allProperties);if(i!==t){var v=m(i);for(o=0;o<v.length;o++){_(i,v[o],this.getPropertyValue(e,v[o]))}n.$.set(s.allProperties,i)}}if(g(s.show)){i=this.isShowing(e);n.$.set(s.show,i)}if(g(s.hide)){i=this.isShowing(e);n.$.set(s.hide,!i)}if(g(s.enabled)){i=this.getPropertyValue(e,"disabled");n.$.set(s.enabled,!i)}if(g(s.disabled)){i=this.getPropertyValue(e,"disabled");n.$.set(s.disabled,i)}if(g(s.readOnly)){i=this.getPropertyValue(e,"readOnly");n.$.set(s.readOnly,i)}if(g(s.readWrite)){i=this.getPropertyValue(e,"readOnly");n.$.set(s.readWrite,!i)}function g(e){return e&&typeof e!=="function"}},getValue:function(e){var n=e.nodeName;if(n==="INPUT"||n==="TEXTAREA"){if(e.type==="checkbox"){return e.checked}else if(e.type==="radio"){return e.checked?e.value:t}else{return e.value}}else if(n==="SELECT"){if(e.multiple){var r=[];for(var i=0;i<e.options.length;i++){if(e.options[i].selected){r.push(w(e.options[i]))}}return r}else if(e.selectedIndex!==-1){return w(e.options[e.selectedIndex])}else{return t}}else if(n==="IMG"){return e.src}else{return e.innerHTML}},getAttributeValue:function(e,t){t=h(t);return e.getAttribute(t)},getPropertyValue:function(e,t){return b(e,t)},addRemoveClasses:function(e,t){var n=p(t);var i=p(this.getAttributeValue(e,"class"));var o=e[r.settings.addedClassesKey];if(!o){o=[];e[r.settings.addedClassesKey]=o}var s,a,l;for(s=0;s<o.length;s++){a=c(n,o[s]);if(a===-1){l=c(i,o[s]);if(l!==-1){i.splice(l,1)}o.splice(s,1);s--}}for(s=0;s<n.length;s++){var u=n[s];a=c(o,u);if(a===-1){l=c(i,u);if(l===-1){i.push(u);o.push(u)}}}this.setAttributeValue(e,"class",i.join(" "));function p(e){if(e===null||!e){return[]}else if(typeof e==="string"){return e.split(" ")}else if(f(e)){return e}else{throw M("Unsupported value for add class: "+typeof e)}}},show:function(e){if(e.style.display!=="none"){return}var n=e[r.settings.oldDisplayKey];if(n===t){n=""}e.style.display=n},hide:function(e){if(e.style.display==="none"){return}e[r.settings.oldDisplayKey]=e.style.display;e.style.display="none"},isShowing:function(e){return e.style.display!=="none"},added:function(e){},remove:function(e){e.parentNode.removeChild(e)}}};r.getNodeOptions=r.defaultGetNodeOptions=function(e,i){var o=d({bindings:{}},i);var s=o.bindings;var a=e.nodeName;if(a==="INPUT"||a==="TEXTAREA"||a==="SELECT"){if(s.key===t){s.key=e.getAttribute("name")}}var l=r.settings;var u=e.attributes;if(u===t){throw M("Unexpected object, expected DOM node: "+e)}for(var c=0;c<u.length;c++){var p=u[c].name;var h=g(p);if(h){var v=k(u[c].value);if(!v&&h.name!=="noBind"){continue}switch(h.name){case"key":{s.key=C(v);break}case"attributePrefix":{_(h.suffix,C(v));break}case"attributes":{s.allAttributes=v;break}case"template":{y();s.template=i.templateEngine.compile(v);break}case"templateId":{y();s.template=i.templateEngine.compile(b(v));break}case"templateAttributePrefix":{y();w(h.suffix,i.templateEngine.compile(v));break}case"templateIdAttributePrefix":{y();w(h.suffix,i.templateEngine.compile(b(v)));break}case"propertyPrefix":{$(h.suffix.replace(/-/g,"."),C(v));break}case"properties":{s.allProperties=v;break}case"on":{x(A(e),N(v));break}case"onPrefix":{x(h.suffix.toLowerCase(),N(v));break}case"show":{s.show=C(v);break}case"hide":{s.hide=C(v);break}case"repeat":{s.repeat=v;break}case"repeatContainerId":{s.repeatContainerId=v;break}case"enabled":{s.enabled=C(v);break}case"disabled":{s.disabled=C(v);break}case"readOnly":{s.readOnly=C(v);break}case"readWrite":{s.readWrite=C(v);break}case"options":{s.selectOptions=v;break}case"classAttribute":{s.classAttribute=C(v);break}case"classAddAttribute":{s.classAddAttribute=C(v);break}case"noBind":{s.noBind=!v||v==="true";break}case"update":{if(v==="auto"||v==="auto-nokey"||v==="noauto"||v==="disabled"){s.update=v}else{throw M("Invalid value for consistent update attribute, expected auto, auto-nokey, noauto, or disabled, saw: "+v)}break}case"scope":case"init":case"initFunc":case"controller":{break}case"warningPrefix":{if(typeof console!=="undefined"&&console.log!==t){console.log('Warning: Unrecognised Consistent attribute "'+p+'" on '+e.nodeName+" element.")}break}default:{throw M("Unhandled consistent declaration attribute: "+p)}}}}function g(e){for(var t in l.attributes){var n=l.attributes[t];var r;var i=t.lastIndexOf("Prefix");if(i!==-1&&i===t.length-"Prefix".length){if(f(n)){for(r=0;r<n.length;r++){if(e.indexOf(n[r])===0){return{name:t,suffix:e.substring(n[r].length)}}}}else if(e.indexOf(n)===0){return{name:t,suffix:e.substring(n.length)}}}else{if(f(n)){for(r=0;r<n.length;r++){if(e===n[r]){return{name:t}}}}else if(e===n){return{name:t}}}}return false}function y(){if(!i.templateEngine){throw M("templateEngine not configured in options")}}function b(e){var t=n.getElementById(e);if(t!==null){return t.innerHTML}else{throw M("Template not found with id: "+e)}}function m(){if(s.attributes===t){s.attributes=[]}}function _(e,t){m();s.attributes.push({name:e,key:t})}function w(e,t){m();s.attributes.push({name:e,template:t})}function $(e,n){if(s.properties===t){s.properties=[]}s.properties.push({name:e,key:n})}function x(e,n){if(s.events===t){s.events={}}if(s.events[e]===t){s.events[e]={keys:[]}}s.events[e].keys.push(n)}function A(e){var t=e.nodeName;if(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"){return"change"}else if(t==="FORM"){return"submit"}else{return"click"}}function k(e){return e.replace(/^\s*(.*)\s*$/,"$1")}function S(e){return e.match(/^[a-zA-Z_$][a-zA-Z_$0-9\.]*$/)}function C(e){if(S(e)){return e}else{return r.expressionToFunction(e)}}function N(e){if(S(e)){return e}else{return r.statementToFunction(e)}}return o};function A(e,n,i,o){if(o===t){o=[]}if(c(o,e)!==-1){return true}o.push(e);var s=i.$.options();var a=s.valueFunctionPrefix;var l;var u=[];var p=0;for(var d in e){if(c(u,d)!==-1){continue}var h=e[d];if(typeof h==="function"){if(!a){e[d]=h.call(i,n)}else if(d.indexOf(a)===0){l=S(d,a);e[l]=h.call(i,n);delete e[d];if(l!==d){u.push(l)}}}else if(typeof h==="object"&&h!==null){if(r.isScope(h)){if(n===i){e[d]=h.$.snapshot()}else{delete e[d];p++}}else{var v=A(h,n,i,o);if(!v){delete e[d]}}}}if(p>0&&f(e)&&p===e.length){return false}return true}r.defaultEmptyScope={$:{_type:s,_scope:null,_controller:null,_manager:null,index:t,apply:function(e,n,r){if(typeof e==="function"){if(typeof n==="boolean"){r=n;n=t}n=e;e=t}else if(typeof e==="boolean"){r=e;e=t}else if(typeof n==="boolean"){r=n;n=t}var i=this._scope();if(n!==t){n.call(i,e,r)}this._manager().apply(e,r);return i},applyLater:function(n,r,i){if(typeof n==="function"){if(typeof r==="boolean"){i=r;r=t}r=n;n=t}else if(typeof n==="boolean"){i=n;n=t}else if(typeof r==="boolean"){i=r;r=t}var o=this._scope();if(r!==t){r.call(o,n,i)}e.clearTimeout(this._applyLaterTimeout);this._applyLaterTimeout=e.setTimeout(function(){o.$.apply(n,i)},0);return o},needsApply:function(){return this._manager().needsApply()},update:function(e,t){this._manager().update(e,t);return this._scope()},bind:function(e,t){this._manager().bind(e,t);return this._scope()},unbind:function(e){this._manager().unbind(e);return this._scope()},merge:function(e,n){var r=this._scope();var i;if(typeof e==="boolean"){i=p(e,{},n);delete i.$;return p(e,r,i)}else if(n===t){i=p({},e);delete i.$;return p(r,i)}else if(f(n)){for(var o=0;o<n.length;o++){_(r,n[o],b(e,n[o]))}return r}else if(typeof n!=="object"){_(r,n,b(e,n));return r}else{throw M("Invalid keys argument to merge: "+n)}},clear:function(){var e=this._scope();for(var t in e){if(t!=="$"){delete e[t]}}},scope:function(e){if(e===t){return this._scope()}else if(typeof e==="object"){return this._manager().replaceScope(e)}else{throw M("Invalid argument type to scope(newScope): "+typeof e)}},controller:function(e){if(e===t){return this._controller()}else if(typeof e==="object"){this._manager().replaceController(e);return this._scope()}else if(typeof e==="string"){var n=k(e,this.options().eventHandlerPrefix);var r=arguments[1];if(typeof r==="function"){_(this._controller(),n,r);return this._scope()}else{var i=true;if(typeof r==="boolean"){i=r}else if(r!==t){throw M("Invalid argument type for get or set controller function: "+typeof func)}var o=this._controller();var s=b(o,n);if(s!==t){if(typeof s==="function"){return function(){return s.apply(o,arguments)}}else{return s}}else if(i&&this.parent()){return this.parent().$.controller(e)}else{return t}}}else{throw M("Invalid argument type for controller(): "+typeof newController)}},snapshot:function(e,n){if(e!==t&&typeof e!=="boolean"){throw M("Invalid argument type for includeParents: "+typeof e)}var r=this._scope();var i=p(true,{},r);delete i.$;A(i,n!==t?n:r,r);if(e!==false&&this.parent()){i=p(this.parent().$.snapshot(e,n!==t?n:r),i)}return i},nodes:function(e){if(e!==t&&typeof e!=="boolean"){throw M("Invalid argument type for includeParents: "+typeof e)}var n=this._manager()._domNodes;if(e!==false){var r=this.children();for(var i=0;i<r.length;i++){n=n.concat(r[i].$.nodes())}}return n},roots:function(){return this._manager()._rootDomNodes},parent:function(){var e=this._manager()._parentScopeManager;if(e!==null){return e._scope}else{return null}},children:function(){var e=[];var t=this._manager()._childScopeManagers;for(var n=0;n<t.length;n++){e.push(t[n]._scope)}return e},watch:function(e,t){this._manager().watch(e,t);return this._scope()},unwatch:function(e,t){this._manager().unwatch(e,t);return this._scope()},get:function(e,n,r){if(n!==t&&typeof n!=="boolean"){throw M("Invalid argument type for includeParents: "+typeof n)}if(e==="$"||e.substring(0,2)==="$."){return t}var i=this.options().valueFunctionPrefix;var o=this._scope();var s=y(e);var a=b(o,s);if(a!==t){if(!i&&typeof a==="function"){return a.call(o,r!==t?r:o)}else{return a}}else{var l;if(i){l=k(s,i);a=b(o,l);if(typeof a==="function"){return a.call(o,o)}}}if(n!==false&&this.parent()){return this.parent().$.get(e,n,r!==t?r:o)}else{return t}},set:function(e,n){var r=this._scope();var i=b(r,e);if(typeof i==="undefined"){var o=this.getValueFunction(e);if(o!==t){o.call(null,r,n);return r}}if(typeof i!=="function"){_(r,e,n)}else if(!this.options().valueFunctionPrefix){i.call(r,r,n)}else{_(r,e,n)}return r},fire:function(e){var n=this.controller(e);var r=this._scope();if(n!==t){var i=[r].concat(Array.prototype.slice.call(arguments,1));return n.apply(null,i)}else{return t}},getValueFunction:function(e,n){if(n!==t&&typeof n!=="boolean"){throw M("Invalid argument type for includeParents: "+typeof n)}var r=this._scope();var i=this.options().valueFunctionPrefix;if(i&&b(r,e)!==t){return t}var o=b(r,k(e,i));if(o!==t){if(typeof o==="function"){return function(){return o.apply(r,arguments)}}else{return t}}else if(n!==false&&this.parent()){return this.parent().$.getValueFunction(e)}else{return t}},setValueFunction:function(e,t){e=k(e,this.options().valueFunctionPrefix);var n=this._scope();_(n,e,t);return n},options:function(e){return this._manager().getOptions(e)},evaluate:function(e){var t=r.expressionToFunction(e);var n=this.snapshot();return $(t,n)},exec:function(e){var t=r.statementToFunction(e);return x(t,this._scope())}}};function k(e,t){if(!t){return e}var n=e.split(".");var r="";for(var i=0;i<n.length-1;i++){r+=n[i]+"."}var o=n[n.length-1];if(C(t)){r+=t+o.substring(0,1).toUpperCase()+o.substring(1)}else{r+=t+o}return r}function S(e,n){if(n===t){return e}if(C(n)){var r=e.substring(n.length);return r.substring(0,1).toLowerCase()+r.substring(1)}else{return e.substring(n.length)}}function C(e){if(!e){return false}var t=e.charAt(e.length-1);return t>="A"&&t<="Z"||t>="a"&&t<="z"}function N(e,n,r,i,o,s){if(r===t){r=""}if(i===t){i=0}if(o===t){o=[]}if(s===t){s=[]}if(c(s,e)!==-1||c(s,n)!==-1){return o}s.push(e);s.push(n);if(e===n){return o}var a;if(n!==null){for(a in e){if(e[a]!==n[a]){if(typeof e[a]==="object"&&typeof n[a]==="object"&&e[a]&&n[a]){N(e[a],n[a],r+a+".",i+1,o,s)}else{o.push(r+a)}}}}else{for(a in e){o.push(r+a)}}for(a in n){if(e===null||e[a]===t){o.push(r+a)}}return o}function E(e,t){var n=typeof e;if(n!==typeof t){return false}if(n==="function"){return e===t}else if(n==="object"){var r=N(e,t);return r.length===0}else{return true}}function I(e,t){for(var n=0;n<t.length;n++){e.removeAttribute(t[n])}}V.prototype={};var T=0;var P=0;var O="$all";function V(e,t){this._id="ConsistentScope"+T;T++;if(t.name){this._name=t.name}if(e){this._parentScopeManager=e.$._manager();this._parentScopeManager._childScopeManagers.push(this)}else{this._parentScopeManager=null}this._childScopeManagers=[];this._options=t;this._nodes=[];this._domNodes=[];this._repeatNodes=[];this._rootDomNodes=[];this._watchers={};this._nodesDirty=false;this._applying=false;this._repeatNodeScope=false;this._scope=d({},r.defaultEmptyScope);this._controller={$:this._scope.$};var n=this;this._scope.$._manager=function(){return n};this._scope.$._scope=function(){return n._scope};this._scope.$._controller=function(){return n._controller};this._cleanScopeSnapshot=this._scope.$.snapshot()}V.prototype.apply=function(e,n){if(this._applying){return}this._applying=true;var r,i;if(this._updateCleanScopeAndFireWatchers()||this._nodesDirty){i=this._nodes.length;var o;for(r=0;r<i;r++){var s=this._nodes[r];o=e!==t?d({},s.options,e):s.options;o.$.apply(s.dom,this._cleanScopeSnapshot,o)}i=this._repeatNodes.length;for(r=0;r<i;r++){var a=this._repeatNodes[r];o=e!==t?d({},a.options,e):a.options;this._handleRepeat(a,o,this._cleanScopeSnapshot)}if(n!==false){var l=this._scope.$.children();for(r=0,i=l.length;r<i;r++){var f=l[r];if(f.$._manager()._repeatNodeScope){continue}f.$.apply(true)}}this._nodesDirty=false;if(this._parentScopeManager){this._parentScopeManager._scope.$.apply(e)}var u=e!==t?d({},this._options,e):this._options;u.$.afterApply(this._scope,this._cleanScopeSnapshot)}this._applying=false};V.prototype._handleRepeat=function(e,i,o){var s=i.bindings.repeat;var a;var l=this._scope.$.get(s);var f=b(o,s);if(f===t){return}if(typeof f!=="object"){throw M('Repeat for key "'+s+'" is not an object in the scope, found '+typeof f)}e.version++;var u=e.version;var c=e.insertBefore;var p=c.parentNode;var d=null;var h;var v=n.activeElement;var g=false;for(a=l.length-1;a>=0;a--){var y=l[a];h=k(y);var m=false;if(h===t){var _=S();var w=r(this._scope,this._options);w.$._manager()._repeatNodeScope=true;w.$.bind(_);w=w.$.scope(y);h={object:y,domNodes:_,scope:w,version:u};e.items.push(h);m=true}else{h.version=u}var $=h.domNodes[h.domNodes.length-1];if(m||$.nextSibling!==c){C(h.domNodes,c,p)}if(m){for(var x=0;x<h.domNodes.length;x++){i.$.added(h.domNodes[x])}}h.before=c;d=c=h.domNodes[0];h.scope.$.index=a;h.scope.$.apply()}var A=[];for(a=e.items.length-1;a>=0;a--){h=e.items[a];if(h.version!==u){C(h.domNodes,h.before,p);h.scope.$.unbind(h.domNodes);A=A.concat(h.domNodes);e.items.splice(a,1);h.scope.$.index=t}}if(A.length){for(a=A.length-1;a>=0;a--){i.$.remove(A[a])}}if(g&&v){v.focus()}function k(n){var r=e.items.length;for(var i=0;i<r;i++){var o=e.items[i];if(o.object===n){return o}}return t}function S(){var t=[];var n=e.domNodes.length;for(var r=0;r<n;r++){t.push(e.domNodes[r].cloneNode(true))}return t}function C(e,t,n){var r=e.length;for(var i=0;i<r;i++){var o=e[i];n.insertBefore(o,t);if(o===v){g=true}}}};V.prototype.update=function(e,n){var r,i,o;if(e===t){i=this._nodes.length;for(r=0;r<i;r++){o=this._nodes[r];o.options.$.update(o.dom,this._scope,o.options)}}else{if(f(e)||D(e)){i=e.length;for(r=0;r<i;r++){this.update(e[r],n)}}else{r=c(this._domNodes,e);if(r!==-1){o=this._nodes[r];o.options.$.update(o.dom,this._scope,o.options)}if(n){var s=e.firstChild;while(s!==null){if(s.nodeType===1){this.update(s,n)}s=s.nextSibling}}}}};V.prototype.needsApply=function(){if(this._nodesDirty){return true}return this.isDirty()};V.prototype.isDirty=function(){return N(this._scope.$.snapshot(),this._cleanScopeSnapshot).length!==0};V.prototype._updateCleanScopeAndFireWatchers=function(){var e=false;var t;var n=true;var i=0;var o=this._cleanScopeSnapshot;var s={};while(n){var a=this._scope.$.snapshot();t=[];while(n){n=false;if(i>=r.settings.maxWatcherLoops){throw M("Too many loops while notifying watchers. There is likely to be an infinite loop caused by watcher functions continously changing the scope. You may otherwise increase Consistent.settings.maxWatcherLoops if this is not the case.")}var l=N(a,o);l=p(l);for(var f=0;f<l.length;f++){var u=l[f];if(c(t,u)===-1){t.push(u)}n|=this._notifyWatchers(u,b(a,u),b(o,u),this._scope,s)}i++}if(t.length>0){n|=this._notifyWatchAlls(t,this._scope,a,o,s);e=true}o=a}if(e){this._cleanScopeSnapshot=this._scope.$.snapshot();return true}else{return false}function p(e){var t=[].concat(e);for(var n=0;n<e.length;n++){var r=e[n];while(true){var i=r.lastIndexOf(".");if(i!==-1){r=r.substring(0,i);if(c(t,r)===-1){t.push(r)}else{break}}else{break}}}return t}};V.prototype._notifyWatchers=function(e,n,i,o,s){var a=false;var l=this._watchers[e];if(l!==t){for(var f=0;f<l.length;f++){var u=s[e];if(u===t){s[e]=u={}}var c=l[f];var p=c[r.settings.functionIdKey];if(p===t){p=c[r.settings.functionIdKey]="ConsistentFunction"+P;P++}if(u[p]===t||!E(u[p].cleanValue,n)){c.call(this._scope,o,v(e),n,i);u[p]={cleanValue:b(o.$.snapshot(),e)};a=true}}}if(this._parentScopeManager){a|=this._parentScopeManager._notifyWatchers(e,n,i,o,s)}return a};V.prototype._notifyWatchAlls=function(e,n,i,o,s){var a=false;var l=this._watchers[O];if(l!==t){for(var f=0;f<l.length;f++){var u=s[O];if(u===t){s[O]=u={}}var c=l[f];var p=c[r.settings.functionIdKey];if(p===t){p=c[r.settings.functionIdKey]="ConsistentFunction"+P;P++}if(u[p]===t||!E(i,u[p].cleanScopeSnapshot)){l[f].call(this._scope,n,g(e),i,o);u[p]={cleanScopeSnapshot:n.$.snapshot()};a=true}}}if(this._parentScopeManager){a|=this._parentScopeManager._notifyWatchAlls(e,n,i,o,s)}return a};function F(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}else{throw M("Unable to attach event to DOM node. Cannot find supported method.")}}function j(e){if(!e.preventDefault){e.preventDefault=function(){this.returnValue=false}}}function L(e,t){var r;if(n.createEvent){r=n.createEvent("HTMLEvents");r.initEvent(t,true,true);e.dispatchEvent(r)}else if(n.createEventObject){e.fireEvent("on"+t)}else{throw M("Unable to fire a DOM event. Cannot find supported method.")}return r}function D(e){return e.length!==t&&e.attributes===t}V.prototype.bind=function(e,i,o){var s;if(f(e)||D(e)){for(s=0;s<e.length;s++){this.bind(e[s],i,o)}return}var l;if(e[r.settings.scopeIdKey]!==this._id){l=d({},this._options,i);l=l.$.getNodeOptions(e,l);if(l.bindings.noBind){return}e[r.settings.scopeIdKey]=this._id;if(o===t){this._rootDomNodes.push(e)}if(!u(l.bindings)){if(l.bindings.repeat!==t){var c={version:0,items:[],options:l};var p=l.bindings.repeat;if(l.bindings.repeatContainerId){var h=n.getElementById(l.bindings.repeatContainerId);if(h!==null){c.domNodes=h.children}else{throw M("Couldn't find element with id \""+l.bindings.repeatContainerId+'" for repeat container.')}}else{c.domNodes=[e.cloneNode(true)]}for(s=0;s<c.domNodes.length;s++){I(c.domNodes[s],r.settings.attributes.repeat);I(c.domNodes[s],r.settings.attributes.repeatContainerId)}var v=n.createComment("Consistent repeat "+p);e.parentNode.insertBefore(v,e);e.parentNode.removeChild(e);v[r.settings.scopeIdKey]=this._id;c.insertBefore=n.createComment("/Consistent repeat "+p);v.parentNode.insertBefore(c.insertBefore,v.nextSibling);this._repeatNodes.push(c);this._nodesDirty=true}else{this._nodes.push({dom:e,options:l});this._domNodes.push(e);this._nodesDirty=true;var g=this;var y=e.nodeName;var b=l.bindings.update;if((!b||b==="auto"||b==="auto-nokey")&&l.autoListenToChange&&(y==="INPUT"||y==="TEXTAREA"||y==="SELECT")){var m=function(t){j(t);l.$.update(e,g._scope,l);g._nodesDirty=true;g._scope.$.apply()};F(e,"change",m,false);if(a.needAggressiveChangeHandlingOnInputElements&&(y==="INPUT"&&(e.type==="checkbox"||e.type==="radio"))){F(e,"click",m,false)}l.$._changeListener=m}if((!b||b==="auto")&&l.autoListenToKeyEvents&&(y==="INPUT"||y==="TEXTAREA")){var m=function(t){j(t);l.$.update(e,g._scope,l);g._nodesDirty=true;g._scope.$.apply()};F(e,"keyup",m,false);l.$._keyListener=m}for(var _ in l.bindings.events){(function(r,i){var o=function(o){var s;j(o);if(a.needChangeEventForActiveOnSubmit&&r==="submit"&&e.nodeName==="FORM"){for(s=0;s<e.elements.length;s++){if(n.activeElement===e.elements[s]){L(e.elements[s],"change")}}}for(s=0;s<i.length;s++){var l=i[s];var f;var u;if(typeof l==="function"){u=x(l,g._scope);if(typeof u!=="function"){o.preventDefault();g._scope.$.apply();continue}else{f=u}}if(f===t){f=g._scope.$.controller(l)}if(f!==t){if(f){u=f(g._scope,o,e);if(u===false)break}}else{o.preventDefault();var c=g._options.eventHandlerPrefix;throw M('Bound "'+r+'" event cannot find an event handler function in "'+k(l,c)+'"')}}};l.bindings.events[r].listener=o;F(e,r,o)})(_,l.bindings.events[_].keys)}}}}if(l===t||!l.bindings.repeat){var w=e.firstChild;while(w!==null){if(w.nodeType===1){this.bind(w,i,e)}w=w.nextSibling}}};V.prototype.unbind=function(e){var n;if(f(e)||D(e)){for(n=0;n<e.length;n++){
this.unbind(e[n])}return}n=c(this._domNodes,e);if(n!==-1){var r=this._nodes[n];var i=r.options;for(var o in i.bindings.events){e.removeEventListener(o,i.bindings.events[o].listener,false)}if(i.$._changeListener!==t){e.removeEventListener("change",i.$._changeListener,false)}if(i.$._keyListener!==t){e.removeEventListener("keyup",i.$._keyListener,false)}this._domNodes.splice(n,1);this._nodes.splice(n,1)}var s=e.firstChild;while(s!==null){if(s.nodeType===1){this.unbind(s)}s=s.nextSibling}};V.prototype.watch=function(e,n){if(typeof e==="function"&&n===t){n=e;e=O}else{e=y(e)}var r=this._watchers[e];if(r===t){r=[];this._watchers[e]=r}r.push(n)};V.prototype.unwatch=function(e,n){if(typeof e==="function"&&n===t){n=e;e=O}else{e=y(e)}var r=this._watchers[e];if(r!==t){var i=c(r,n);r.splice(i,1)}};V.prototype.getOptions=function(e){if(e===t){return this._options}for(var n=0;n<this._nodes.length;n++){if(this._nodes[n].dom===e){return this._nodes[n].options}}return null};V.prototype.replaceScope=function(e){e.$=this._scope.$;this._scope=e;return e};V.prototype.replaceController=function(e){e.$=this._scope.$;this._controller=e};V.prototype.destroy=function(){this.unbind(this._rootDomNodes)};function M(e){return new W(e)}W.prototype={};function W(e){this.name="ConsistentException";this.message=e}W.prototype.toString=function(){return"Consistent.js exception: "+this.message}})(window);/*!
 * Consistent.js Expressions 0.12.6
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
(function(e,t){if(typeof Consistent==="undefined"){throw"Consistent must be included before consistent-expressions.js"}Consistent.expressionToFunction=function(e){var t=f(e);var n=u(t,false,e);try{return new Function("ctx",n)}catch(r){throw"Error compiling expression: "+e+" => "+n+" ("+r+")"}};Consistent.statementToFunction=function(e){var t=f(e);var n=u(t,true,e);try{return new Function("ctx",n)}catch(r){throw"Error compiling statements: "+e+" => "+n+" ("+r+")"}};var n=0;var r=1;var i=2;var o=3;var s=4;var a=5;var l=6;function f(e){var t=[];var f=0;var u=e.length;var c=n;var b="";while(f<u){var m=e.charAt(f);if(c===n){if(p(m)){c=r}else if(h(m)){c=s}else if(g(m)){c=i}else if(y(m)){c=o}else if($(m)){c=a}else if(w(m)){c=l}else if(v(m)){throw"Illegal escape character at "+f+": "+e}else if(A(m)){f++;continue}else{throw"Invalid character '"+m+"' at "+f+": "+e}}else if(c===r){if(!d(m)){_();continue}}else if(c===i){if(!g(m)){_();continue}}else if(c===o){_();continue}else if(c===s){if(h(m)){b+=m;f++;_();continue}else if(v(m)){b+=m;f++;m=e.charAt(f)}}else if(c===a){if(!x(m)){_();continue}}else if(c===l){_();continue}b+=m;f++}function _(){if(b.length>0){if(c===r&&k(b)){var e=S(b);if(e!==null){t.push({type:i,text:e})}else{t.push({type:a,text:b})}}else{t.push({type:c,text:b})}}b="";c=n}_();return t}function u(e,t,n){var f=[];var p=[[]];var d=[[]];var h=0;var v,g=e.length;for(v=0;v<g;v++){var y=p[p.length-1];var b=d[d.length-1];var w=e[v];var $=w.type;if($===r){if(t){var x=v+1<g?e[v+1]:null;if(x!==null&&x.type===i&&m(x.text)){y.push('ctx.set("'+c(w.text)+'", ');b.unshift(")");var A=_(x.text);if(A){y.push('ctx.get("'+c(w.text)+'")');y.push(A)}v++;continue}}y.push('ctx.get("'+c(w.text)+'")')}else if($===i){if(m(w.text)){throw"Assignment is invalid in expression: "+n}else{y.push(w.text)}}else if($===s||$===a){y.push(w.text)}else if($===o){if(w.text==="("){p.push([]);d.push([])}else{if(!y.length||p.length<2){throw"Invalid bracketed expression in expression: "+n}f.push("var __group"+h+" = "+y.join(" ")+b.join(" ")+";");p.pop();d.pop();y=p[p.length-1];y.push("__group"+h);h++}}else if($===l){if(t){y.push(d[0].join(" ")+";");d[0]=[];var k=u(e.slice(v+1),true,n);y.push(k);break}else{throw"Invalid multiple statements in expression: "+n}}}if(p.length!==1){throw"Unbalanced bracketed expressions in expression: "+n}return f.join(" ")+(v==g?" return ":"")+p[0].join(" ")+d[0].join(" ")+";"}function c(e){return e.replace(/"/g,'\\"')}function p(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"||e==="$"}function d(e){return p(e)||e==="."||e>="0"&&e<="9"}function h(e){return e==="'"||e==='"'}function v(e){return e==="\\"}function g(e){return e==="!"||e==="%"||e==="="||e==="<"||e===">"||e==="*"||e==="/"||e==="+"||e==="-"||e==="^"||e==="&"||e==="?"||e===":"}function y(e){return e==="("||e===")"}function b(e){return e==="="||e==="+="||e==="-="||e==="*="||e==="/="||e==="%="}function m(e){return b(e)||e==="++"||e==="--"}function _(e){if(e==="="){return null}else if(e.length==2&&e.indexOf("=")===1){return e.charAt(0)}else if(e==="++"){return"+1"}else if(e==="--"){return"-1"}else{throw"Unsupported mutation operator: "+e}}function w(e){return e===";"}function $(e){return e>="0"&&e<="9"}function x(e){return $(e)||e=="."}function A(e){return e<=" "}function k(e){return e==="true"||e==="false"||e==="null"||e==="undefined"||e==="and"||e==="or"||e==="not"||e==="lt"||e==="le"||e==="gt"||e==="ge"||e==="eq"||e==="ne"}function S(e){if(e==="and"){return"&&"}else if(e==="or"){return"||"}else if(e==="not"){return"!"}else if(e==="lt"){return"<"}else if(e==="le"){return"<="}else if(e==="gt"){return">"}else if(e==="ge"){return">="}else if(e==="eq"){return"=="}else if(e==="ne"){return"!="}else{return null}}})(window);/*! 
 * Consistent.js jQuery plugin 0.12.6
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
(function(e,t,n){var r=e.consistent=t.Consistent;e.fn.consistent=function(){var e,t;if(arguments.length===0){this.each(function(){var t=r.findScopeForNode(this);if(t){if(e&&e!==t){throw"The given nodes have multiple different scopes"}e=t}else if(e){throw"Some of the given nodes have scopes and others don't"}});if(e){return e}else{e=r()}}else{var n=arguments[0];if(r.isScope(n)){e=n;t=arguments.length>1?arguments[1]:null}else{e=r.apply(null,arguments);t=null}}this.each(function(){e.$.bind(this,t)});return e};e(function(){if(r.settings.autoCreateScopes){r.autoCreateScopes()}})})(jQuery,window);
//# sourceMappingURL=consistent-for-jquery.min.js.map