/*! 
 * Consistent.js 0.5.0
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
!function(e,t){var n=e.Consistent=function(){var e=arguments[0];if(e!==t){if(n.isScope(e)){if(arguments[1]!==t){return n.createScope(e,arguments[1])}else{return n.createScope(e,null)}}else if(e.nodeName!==t){return n.findScopeForNode(e)}else if(typeof e==="object"){return n.createScope(null,e)}else{throw new C("Unexpected argument to Consistent(): "+e)}}else{return n.createScope(null,null)}};var i={};var r="ConsistentScope";var s=function(){var e={};var t=document.createElement("div");t.setAttribute("className","test");e.badGetSetAttribute=t.className==="test";e.needChangeEventForActiveOnSubmit=e.needAggressiveChangeHandlingOnInputElements=!!document.createEventObject;return e}();f(n,{settings:{attributes:{key:["data-ct","ct"],show:["data-ct-show","ct-show"],hide:["data-ct-hide","ct-hide"],enabled:["data-ct-enabled","ct-enabled"],disabled:["data-ct-disabled","ct-disabled"],readOnly:["data-ct-readonly","ct-readonly"],readWrite:["data-ct-readwrite","ct-readwrite"],options:["data-ct-options","ct-options"],template:["data-ct-tmpl","ct-tmpl"],templateId:["data-ct-tmpl-id","ct-tmpl-id"],attributes:["data-ct-attrs","ct-attrs"],attributePrefix:["data-ct-attr-","ct-attr-"],properties:["data-ct-props","ct-props"],propertyPrefix:["data-ct-prop-","ct-prop-"],templateAttributePrefix:["data-ct-tmpl-attr-","ct-tmpl-attr-"],templateIdAttributePrefix:["data-ct-tmpl-id-attr-","ct-tmpl-id-attr-"],on:["data-ct-on","ct-on",,"data-ct-bind","ct-bind"],onPrefix:["data-ct-on-","ct-on-",,"data-ct-bind-","ct-bind-"],repeat:["data-ct-repeat","ct-repeat"],repeatContainerId:["data-ct-repeat-container-id","ct-repeat-container-id"],warningPrefix:["data-ct-","ct-"]},scopeIdKey:"__ConsistentScopeID",functionIdKey:"__ConsistentFunctionID",oldDisplayKey:"__ConsistentOldDisplay",maxWatcherLoops:100},isScope:function(e){return e!==t&&e.$!==t&&e.$._type===r},createScope:function(e,t){t=p({},n.defaultOptions,t);var r=new x(e,t);i[r._id]=r._scope;return r._scope},findScopeForNode:function(e){var t=e[n.settings.scopeIdKey];if(t&&i[t]){return i[t]}else{return null}},merge:f});var o={};function a(e){return o.toString.call(e)==="[object Array]"}function l(e,n,i){if(typeof e.indexOf==="function"){return e.indexOf(n,i)}else{if(i===t){i=0}if(i<0){i+=e.length;if(i<0){i=0}}for(var r=i;r<e.length;r++){if(e[r]===n){return r}}return-1}}function f(){var e=0;var n=false;if(typeof arguments[0]==="boolean"){n=arguments[0];e++}var i=arguments[e];if(typeof i!=="object"&&typeof i!=="function"){throw new C("First object argument to merge is not appropriate: "+typeof i)}if(i===null){throw new C("First object argument to merge is not appropriate: "+i)}for(var r=e+1;r<arguments.length;r++){var s=arguments[r];if(s===t){continue}if(typeof s!=="object"&&typeof s!=="function"){throw new C("Argument "+(r+1)+" to merge is not appropriate: "+typeof s)}for(var o in s){if(o==="$"){continue}var l=s[o];if(l!==t){if(n&&typeof l==="object"&&l!==null){l=f(true,a(l)?[]:{},l)}i[o]=l}}}return i}function p(){var e=[];for(var t=0;t<arguments.length;t++){var n=arguments[t];if(n){e.push(arguments[t].$)}}if(!e[0]){e[0]={}}var i=f.apply(this,arguments);i.$=f.apply(this,e);return i}function c(e){if(!s.badGetSetAttribute){return e}if(e==="class"){return"className"}else{return e}}function u(e,n){var i=n.split(".");var r=e;var s;for(s=0;s<i.length&&r!==t&&r!==null;s++){r=r[i[s]]}if(s===i.length){return r}else{return t}}function d(e,n){if(n===t){n=""}var i=[];for(var r in e){if(typeof e[r]==="object"&&e[r]!==null){i=i.concat(d(e[r],n+r+"."))}else{i.push(n+r)}}return i}function h(e,n,i){var r=n.split(".");var s=e;for(var o=0;o<r.length-1;o++){if(s[r[o]]===t){s[r[o]]={}}s=s[r[o]]}s[r[r.length-1]]=i}function v(e){var t=e.value;if(!t){t=e.text}return t}n.defaultOptions={templateEngine:null,autoListenToChange:true,eventHandlerPrefix:"$",valueFunctionPrefix:"",$:{getNodeOptions:function(e,t){return n.getNodeOptions(e,t)},apply:function(e,n,i){var r,s,o;if(i.selectOptions){s=u(n,i.selectOptions);if(s!==t){var a=e.selectedIndex!==-1?v(e.options[e.selectedIndex]):t;e.length=s.length;for(o=0;o<s.length;o++){var l;if(typeof s[o]==="object"){var f=s[o].text;var p=s[o].value;l=new Option(f!==t?f:"",p!==t?p:"",false,p==a);if(s[o].label!==t){l.label=s[o].label}if(s[o].disabled!==t){l.disabled=!!s[o].disabled}}else{l=new Option(s[o],s[o],false,s[o]==a)}e.options[o]=l}}}if(i.key){s=u(n,i.key);if(s!==t){this.setValue(e,s)}}else if(i.template!==t&&i.template!==null){this.setValue(e,i.template.render(n))}if(i.attributes){var c=i.attributes;for(o=0;o<c.length;o++){if(c[o].key!==t){s=u(n,c[o].key)}else if(c[o].template!==t){s=c[o].template.render(n)}else{s=null}if(s!==t){this.setAttributeValue(e,c[o].name,s)}}}if(i.allAttributes){s=u(n,i.allAttributes);for(r in s){if(s[r]!==t){s=s[r];if(r==="className"){r="class"}this.setAttributeValue(e,r,s)}}}if(i.properties){var h=i.properties;for(o=0;o<h.length;o++){s=u(n,h[o].key);if(s!==t){this.setPropertyValue(e,h[o].name,s)}}}if(i.allProperties){s=u(n,i.allProperties);var g=d(s);for(o=0;o<g.length;o++){var m=u(s,g[o]);if(m!==t){this.setPropertyValue(e,g[o],m)}}}if(i.show){s=u(n,i.show);if(s!==t){if(s){this.show(e)}else{this.hide(e)}}}if(i.hide){s=u(n,i.hide);if(s!==t){if(!s){this.show(e)}else{this.hide(e)}}}if(i.enabled){s=u(n,i.enabled);if(s!==t){this.setPropertyValue(e,"disabled",!s)}}if(i.disabled){s=u(n,i.disabled);if(s!==t){this.setPropertyValue(e,"disabled",!!s)}}if(i.readOnly){s=u(n,i.readOnly);if(s!==t){this.setPropertyValue(e,"readOnly",!!s)}}if(i.readWrite){s=u(n,i.readWrite);if(s!==t){this.setPropertyValue(e,"readOnly",!s)}}},afterApply:function(e,t){},setValue:function(e,t){var n=e.nodeName;if(n==="INPUT"||n==="TEXTAREA"){if(e.type==="checkbox"){if(a(t)){e.checked=e.defaultChecked=l(t,e.value)!==-1}else if(typeof t==="boolean"){e.checked=e.defaultChecked=t}else{e.checked=e.defaultChecked=t==e.value}}else if(e.type==="radio"){e.checked=e.defaultChecked=t==e.value}else{e.value=t}}else if(n==="SELECT"){if(t===null){t=""}var i;if(a(t)){for(i=0;i<e.options.length;i++){e.options[i].selected=l(t,v(e.options[i]))!==-1}}else{for(i=0;i<e.options.length;i++){if(v(e.options[i])==t){e.selectedIndex=i;return}}e.selectedIndex=-1}}else if(n==="IMG"){e.src=t}else{e.innerHTML=t}},setAttributeValue:function(e,t,n){t=c(t);if(n){e.setAttribute(t,n)}else{e.removeAttribute(t)}},setPropertyValue:function(e,t,n){h(e,t,n)},update:function(e,n,i){var r,s;if(i.key){r=this.getValue(e);if(r!==t){if(e.nodeName==="INPUT"&&e.type==="checkbox"){var o=n.$.get(i.key);if(a(o)){s=l(o,e.value);if(r){if(s===-1){o.push(e.value)}}else{if(s!==-1){o.splice(s,1)}}}else if(e.value!=="on"&&(o===t||o===null)){if(r){n.$.set(i.key,e.value)}}else if(typeof o==="boolean"||e.value==="on"){n.$.set(i.key,r)}else if(r&&o!==e.value){n.$.set(i.key,[o,e.value])}}else{n.$.set(i.key,r)}}}if(i.attributes){var f=i.attributes;for(s=0;s<f.length;s++){if(f[s].key!==t){r=this.getAttributeValue(e,f[s].name);n.$.set(f[s].key,r)}}}if(i.allAttributes){r=n.$.get(i.allAttributes);if(r!==t){for(s in r){r[s]=this.getAttributeValue(e,s)}}}if(i.properties){var p=i.properties;for(s=0;s<p.length;s++){r=this.getPropertyValue(e,p[s].name);n.$.set(p[s].key,r)}}if(i.allProperties){r=n.$.get(i.allProperties);if(r!==t){var c=d(r);for(s=0;s<c.length;s++){h(r,c[s],this.getPropertyValue(e,c[s]))}}}if(i.show){r=this.isShowing(e);n.$.set(i.show,r)}if(i.hide){r=this.isShowing(e);n.$.set(i.hide,!r)}if(i.enabled){r=this.getPropertyValue(e,"disabled");n.$.set(i.enabled,!r)}if(i.disabled){r=this.getPropertyValue(e,"disabled");n.$.set(i.disabled,r)}if(i.readOnly){r=this.getPropertyValue(e,"readOnly");n.$.set(i.readOnly,r)}if(i.readWrite){r=this.getPropertyValue(e,"readOnly");n.$.set(i.readWrite,!r)}},getValue:function(e){var n=e.nodeName;if(n==="INPUT"||n==="TEXTAREA"){if(e.type==="checkbox"){return e.checked}else if(e.type==="radio"){return e.checked?e.value:t}else{return e.value}}else if(n==="SELECT"){if(e.multiple){var i=[];for(var r=0;r<e.options.length;r++){if(e.options[r].selected){i.push(v(e.options[r]))}}return i}else if(e.selectedIndex!==-1){return v(e.options[e.selectedIndex])}else{return t}}else if(n==="IMG"){return e.src}else{return e.innerHTML}},getAttributeValue:function(e,t){t=c(t);return e.getAttribute(t)},getPropertyValue:function(e,t){return u(e,t)},show:function(e){if(e.style.display!=="none"){return}var i=e[n.settings.oldDisplayKey];if(i===t){i=""}e.style.display=i},hide:function(e){if(e.style.display==="none"){return}e[n.settings.oldDisplayKey]=e.style.display;e.style.display="none"},isShowing:function(e){return e.style.display!=="none"},added:function(e){},remove:function(e){e.parentNode.removeChild(e)}}};n.defaultOptions.$.$original=n.defaultOptions.$;n.getNodeOptions=n.defaultGetNodeOptions=function(e,i){var r=p({},i);var s=e.nodeName;if(s==="INPUT"||s==="TEXTAREA"||s==="SELECT"){if(r.key===t){r.key=e.getAttribute("name")}}var o=n.settings;var l=e.attributes;for(var f=0;f<l.length;f++){var c=l[f].name;var u=l[f].value;var d=h(c);if(d){switch(d.name){case"key":{r.key=u;break}case"attributePrefix":{y(d.suffix,u);break}case"attributes":{r.allAttributes=u;break}case"template":{v();r.template=i.templateEngine.compile(u);break}case"templateId":{v();r.template=i.templateEngine.compile(g(u));break}case"templateAttributePrefix":{v();b(d.suffix,i.templateEngine.compile(u));break}case"templateIdAttributePrefix":{v();b(d.suffix,i.templateEngine.compile(g(u)));break}case"propertyPrefix":{_(d.suffix.replace(/-/g,"."),u);break}case"properties":{r.allProperties=u;break}case"on":{w($(e),u);break}case"onPrefix":{w(d.suffix.toLowerCase(),u);break}case"show":{r.show=u;break}case"hide":{r.hide=u;break}case"repeat":{r.repeat=u;break}case"repeatContainerId":{r.repeatContainerId=u;break}case"enabled":{r.enabled=u;break}case"disabled":{r.disabled=u;break}case"readOnly":{r.readOnly=u;break}case"readWrite":{r.readWrite=u;break}case"options":{r.selectOptions=u;break}case"warningPrefix":{if(console.log!==t){console.log('Warning: Unrecognised Consistent attribute "'+c+'" on '+e.nodeName+" element.")}break}default:{throw new C("Unhandled consistent declaration attribute: "+c)}}}}function h(e){for(var t in o.attributes){var n=o.attributes[t];var i;if(t.lastIndexOf("Prefix")===t.length-"Prefix".length){if(a(n)){for(i=0;i<n.length;i++){if(e.indexOf(n[i])===0){return{name:t,suffix:e.substring(n[i].length)}}}}else if(e.indexOf(n)===0){return{name:t,suffix:e.substring(n.length)}}}else{if(a(n)){for(i=0;i<n.length;i++){if(e===n[i]){return{name:t}}}}else if(e===n){return{name:t}}}}return false}function v(){if(!i.templateEngine){throw new C("templateEngine not configured in options")}}function g(e){var t=document.getElementById(e);if(t!==null){return t.innerHTML}else{throw new C("Template not found with id: "+e)}}function m(){if(r.attributes===t){r.attributes=[]}}function y(e,t){m();r.attributes.push({name:e,key:t})}function b(e,t){m();r.attributes.push({name:e,template:t})}function _(e,n){if(r.properties===t){r.properties=[]}r.properties.push({name:e,key:n})}function w(e,n){if(r.events===t){r.events={}}if(r.events[e]===t){r.events[e]={keys:[]}}r.events[e].keys.push(n)}function $(e){var t=e.nodeName;if(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"){return"change"}else if(t==="FORM"){return"submit"}else{return"click"}}return r};function g(e,t){var n=t.$.options();var i=n.eventHandlerPrefix;var r=n.valueFunctionPrefix;for(var s in e){if(s.indexOf(i)===0){delete e[s]}else if(typeof e[s]==="function"){if(!r||s.indexOf(r)===0){e[s]=e[s].call(t)}else{delete e[s]}}else if(typeof e[s]==="object"&&e[s]!==null){g(e[s],t)}}}n.defaultEmptyScope={$:{_type:r,_scope:null,_manager:null,index:t,apply:function(e,n){if(typeof e==="function"){n=e;e=t}if(n!==t){n.call(this._scope,e)}this._manager.apply(e);return this._scope},applyLater:function(n,i){if(typeof n==="function"){i=n;n=t}if(i!==t){i.call(this._scope,n)}e.clearTimeout(this._scope.$._applyLaterTimeout);var r=this;this._scope.$._applyLaterTimeout=e.setTimeout(function(){r._scope.$.apply(n)},0);return this._scope},needsApply:function(){return this._manager.needsApply()},update:function(){this._manager.update();return this._scope},bind:function(e,t){this._manager.bind(e,t);return this._scope},merge:function(e,n){if(n===t){return f(this._scope,e)}else{for(var i=0;i<n.length;i++){h(n[i],u(e,n[i]))}return this._scope}},replace:function(e){return this._manager.replaceScope(e)},clear:function(){for(var e in this._scope){if(e!=="$"){delete this._scope[e]}}},snapshot:function(e){var n=this._scope.$.snapshotLocal(e);if(this.parent()){n=f(this.parent().$.snapshot(e!==t?e:this._scope),n)}return n},snapshotLocal:function(e){var n=f(true,{},this._scope);g(n,e!==t?e:this._scope);return n},nodes:function(){return this._manager._domNodes},roots:function(){return this._manager._rootDomNodes},parent:function(){return this._manager._parentScope},watch:function(e,t){this._manager.watch(e,t);return this._scope},unwatch:function(e,t){this._manager.unwatch(e,t);return this._scope},get:function(e){var n=this.getLocal(e);if(n!==t){return n}else if(this.parent()){return this.parent().$.get(e)}else{return t}},getLocal:function(e){return u(this._scope,e)},set:function(e,n){var i=e.split(".");var r=this._scope;for(var s=0;s<i.length-1;s++){var o=r[i[s]];if(o===t){r=r[i[s]]={}}else{r=o}}if(typeof r[i[i.length-1]]!=="function"){r[i[i.length-1]]=n}else{r[i[i.length-1]].call(this._scope,n)}return this._scope},getEventHandler:function(e){var n=this.getLocalEventHandler(e);if(n!==t){return n}else if(this.parent()){return this.parent().$.getEventHandler(e)}else{return t}},getLocalEventHandler:function(e){e=m(e,this.options().eventHandlerPrefix);return this.getLocal(e)},setEventHandler:function(e,t){e=m(e,this.options().eventHandlerPrefix);return this.set(e,t)},options:function(e){return this._manager.getOptions(e)}}};function m(e,t){if(!t){return e}var n=e.split(".");var i="";for(var r=0;r<n.length-1;r++){i+=n[r]+"."}var s=n[n.length-1];if(s.indexOf(t)!==0){if(y(t)){i+=t+s.substring(0,1).toUpperCase()+s.substring(1)}else{i+=t+s}}else{i+=s}return i}function y(e){if(!e){return false}var t=e.charAt(e.length-1);return t>="A"&&t<="Z"||t>="a"&&t<="z"}function b(e,n,i,r,s,o){if(i===t){i=""}if(r===t){r=0}if(s===t){s=[]}if(o===t){o=[]}if(l(o,e)!==-1||l(o,n)!==-1){return s}o.push(e);o.push(n);var a;for(a in e){if(e[a]!==n[a]){if(typeof e[a]==="object"&&typeof n[a]==="object"){b(e[a],n[a],i+a+".",r+1,s,o)}else{s.push(i+a)}}}for(a in n){if(e[a]===t){s.push(i+a)}}return s}function _(e,t){var n=typeof e;if(n!==typeof t){return false}if(n==="function"){return e===t}else if(n==="object"){var i=b(e,t);return i.length===0}else{return true}}function w(e,t){for(var n=0;n<t.length;n++){e.removeAttribute(t[n])}}x.prototype=new Object;var $=0;var k=0;var S="$all";function x(e,t){this._id="ConsistentScope"+$;$++;this._parentScope=e;this._options=t;this._nodes=[];this._domNodes=[];this._rootDomNodes=[];this._watchers={};this._nodesDirty=false;this._applying=false;this._scope=p({},n.defaultEmptyScope);this._scope.$._manager=this;this._scope.$._scope=this._scope;this._cleanScopeSnapshot=this._scope.$.snapshot()}x.prototype.apply=function(e){if(this._applying){return}this._applying=true;if(this._updateCleanScopeAndFireWatchers()||this._nodesDirty){var n=this._nodes.length;for(var i=0;i<n;i++){var r=this._nodes[i];var s=e!==t?p({},r.options,e):r.options;s.$.apply(r.dom,this._cleanScopeSnapshot,s);if(s.repeat){this._handleRepeat(r,s,this._cleanScopeSnapshot)}}this._nodesDirty=false;if(this._parentScope){this._parentScope.$.apply(e)}var o=e!==t?p({},this._options,e):this._options;o.$.afterApply(this._scope,this._cleanScopeSnapshot)}this._applying=false};x.prototype._handleRepeat=function(e,i,r){var s=i.repeat;var o;var a=e.repeatData;if(a===t){a={version:0,items:[]};if(i.repeatContainerId){var l=document.getElementById(i.repeatContainerId);if(l!==null){a.domNodes=l.children}else{throw new C("Couldn't find element with id \""+i.repeatId+'" for repeat container.')}}else{a.domNodes=[e.dom.cloneNode(true)]}for(o=0;o<a.domNodes.length;o++){w(a.domNodes[o],n.settings.attributes.repeat);w(a.domNodes[o],n.settings.attributes.repeatContainerId)}e.repeatData=a;var f=document.createComment("Consistent repeat "+s);e.dom.parentNode.insertBefore(f,e.dom);e.dom.parentNode.removeChild(e.dom);f[n.settings.scopeIdKey]=this._id;e.dom=f;a.insertBefore=document.createComment("/Consistent repeat "+s);e.dom.parentNode.insertBefore(a.insertBefore,f.nextSibling)}var p=this._scope.$.get(s);var c=u(r,s);if(c===t){return}if(typeof c!=="object"){throw new C('Repeat for key "'+s+'" is not an object in the scope, found '+typeof c)}a.version++;var d=a.version;var h=a.insertBefore;var v=null;var g;for(o=0;o<p.length;o++){var m=p[o];g=k(m);var y=false;if(g===t){var b=S();var _=n(this._scope,this._options);_.$.bind(b);_=_.$.replace(m);g={object:m,domNodes:b,scope:_,version:d};a.items.push(g);y=true}else{g.version=d}N(g.domNodes,h,h.parentNode);if(y){for(var $=0;$<g.domNodes.length;$++){i.$.added(g.domNodes[$])}}g.after=v;v=g.domNodes[g.domNodes.length-1];g.scope.$.index=o;g.scope.$.apply()}for(o=0;o<a.items.length;o++){g=a.items[o];if(g.version!==d){if(g.after){N(g.domNodes,g.after.nextSibling,h.parentNode)}x(g.domNodes);a.items.splice(o,1);g.scope.$.index=t;o--}}function k(e){for(var n=0;n<a.items.length;n++){if(a.items[n].object===e){return a.items[n]}}return t}function S(){var e=[];for(var t=0;t<a.domNodes.length;t++){e.push(a.domNodes[t].cloneNode(true))}return e}function x(e){for(var t=0;t<e.length;t++){i.$.remove(e[t])}}function N(e,t,n){for(var i=0;i<e.length;i++){n.insertBefore(e[i],t)}}};x.prototype.update=function(){var e=this._nodes.length;for(var t=0;t<e;t++){var n=this._nodes[t];n.options.$.update(n.dom,this._scope,n.options)}};x.prototype.needsApply=function(){if(this._nodesDirty){return true}return this.isDirty()};x.prototype.isDirty=function(){return b(this._scope.$.snapshot(),this._cleanScopeSnapshot).length!==0};x.prototype._updateCleanScopeAndFireWatchers=function(){var e=false;var t;var i=true;var r=0;var s=this._cleanScopeSnapshot;var o={};while(i){var a=this._scope.$.snapshot();t=[];while(i){i=false;if(r>=n.settings.maxWatcherLoops){throw new C("Too many loops while notifying watchers. There is likely to be an infinite loop caused by watcher functions continously changing the scope. You may otherwise increase Consistent.settings.maxWatcherLoops if this is not the case.")}var f=b(a,s);for(var p=0;p<f.length;p++){var c=f[p];if(l(t,c)===-1){t.push(c)}i|=this._notifyWatchers(c,u(a,c),u(s,c),this._scope,o)}r++}if(t.length>0){i|=this._notifyWatchAlls(t,this._scope,a,s,o);e=true}s=a}if(e){this._cleanScopeSnapshot=this._scope.$.snapshot();return true}else{return false}};x.prototype._notifyWatchers=function(e,i,r,s,o){var a=false;var l=this._watchers[e];if(l!==t){for(var f=0;f<l.length;f++){var p=o[e];if(p===t){o[e]=p={}}var c=l[f];var u=c[n.settings.functionIdKey];if(u===t){u=c[n.settings.functionIdKey]="ConsistentFunction"+k;k++}if(p[u]===t||!_(p[u].cleanValue,i)){c.call(s,e,i,r);p[u]={cleanValue:s.$.get(e)};a=true}}}if(this._parentScope){this._parentScope.$._manager._notifyWatchers(e,i,r,s,o)}return a};x.prototype._notifyWatchAlls=function(e,i,r,s,o){var a=false;var l=this._watchers[S];if(l!==t){for(var f=0;f<l.length;f++){var p=o[S];if(p===t){o[S]=p={}}var c=l[f];var u=c[n.settings.functionIdKey];if(u===t){u=c[n.settings.functionIdKey]="ConsistentFunction"+k;k++}if(p[u]===t||!_(r,p[u].cleanScopeSnapshot)){l[f].call(i,e,r,s);p[u]={cleanScopeSnapshot:i.$.snapshot()};a=true}}}if(this._parentScope){this._parentScope.$._manager._notifyWatchAlls(e,i,r,s,o)}return a};function N(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}else{throw new C("Unable to attach event to DOM node. Cannot find supported method.")}}function E(e){if(!e.preventDefault){e.preventDefault=function(){this.returnValue=false}}}function A(e,t){var n;if(document.createEvent){n=document.createEvent("HTMLEvents");n.initEvent(t,true,true);e.dispatchEvent(n)}else if(document.createEventObject){e.fireEvent("on"+t)}else{throw new C("Unable to fire a DOM event. Cannot find supported method.")}return n}x.prototype.bind=function(e,i,r){if(a(e)){for(var o=0;o<e.length;o++){this.bind(e[o],i,r)}return}var l;if(e[n.settings.scopeIdKey]!==this._id){l=p({},this._options,i);l=l.$.getNodeOptions(e,l);this._nodes.push({dom:e,options:l});this._domNodes.push(e);if(r===t){this._rootDomNodes.push(e)}this._nodesDirty=true;e[n.settings.scopeIdKey]=this._id;var f=this;for(var c in l.events){!function(n,i){var r=function(r){var o;E(r);if(s.needChangeEventForActiveOnSubmit&&n==="submit"&&e.nodeName==="FORM"){for(o=0;o<e.elements.length;o++){if(document.activeElement===e.elements[o]){A(e.elements[o],"change")}}}for(o=0;o<i.length;o++){var a=i[o];var l=f._scope.$.getEventHandler(a);if(l!==t){var p=l.call(e,r,f._scope);if(p===false)break}else{r.preventDefault();l=f._scope.$.get(a);var c=f._options.eventHandlerPrefix;if(typeof l==="function"){throw new C('Bound "'+n+'" event cannot find an event handler function in "'+m(a,c)+'". There is a function in "'+a+'", which is missing the '+c+" prefix and is possibly a mistake?")}else{throw new C('Bound "'+n+'" event cannot find an event handler function in "'+m(a,c)+'"')}}}};l.events[n].listener=r;N(e,n,r)}(c,l.events[c].keys)}var u=e.nodeName;if(l.autoListenToChange&&(u==="INPUT"||u==="TEXTAREA"||u==="SELECT")){var d=function(t){E(t);l.$.update(e,f._scope,l);f._scope.$.apply()};N(e,"change",d,false);if(s.needAggressiveChangeHandlingOnInputElements&&u==="INPUT"&&(e.type==="checkbox"||e.type==="radio")){N(e,"click",d,false)}l.$._changeListener=d}}if(l===t||!l.repeat){var h=e.firstChild;while(h!==null){if(h.nodeType===1){this.bind(h,i,e)}h=h.nextSibling}}};x.prototype.unbind=function(e){var n;if(a(e)){for(n=0;n<e.length;n++){this.unbind(e[n])}return}n=l(this._domNodes,e);if(n!==-1){var i=this._nodes[n];var r=i.options;for(var s in r.events){e.removeEventListener(s,r.events[s].listener,false)}if(r.$._changeListener!==t){e.removeEventListener("change",r.$._changeListener,false)}this._domNodes.slice(n,1);this._nodes.slice(n,1)}var o=e.firstChild;while(o!==null){if(o.nodeType===1){this.unbind(o)}o=o.nextSibling}};x.prototype.nodes=function(){return _domNodes};x.prototype.watch=function(e,n){if(typeof e==="function"&&n===t){n=e;e=S}var i=this._watchers[e];if(i===t){i=[];this._watchers[e]=i}i.push(n)};x.prototype.unwatch=function(e,n){if(typeof e==="function"&&n===t){n=e;e=S}var i=this._watchers[e];if(i!==t){var r=l(i,n);i.splice(r,1)}};x.prototype.getOptions=function(e){if(e===t){return this._options}for(var n=0;n<this._nodes.length;n++){if(this._nodes[n].dom===e){return this._nodes[n].options}}return null};x.prototype.replaceScope=function(e){e.$=this._scope.$;e.$._scope=e;this._scope=e;return e};C.prototype=new Object;function C(e){this._message=e}C.prototype.toString=function(){return"Consistent.js exception: "+this._message}}(window);/*! 
 * Consistent.js jQuery plugin 0.5.0
 * @author Karl von Randow
 * @license Apache License, Version 2.0
 */
!function(e,t,n){var i=e.consistent=t.Consistent;e.fn.consistent=function(){var e,t;if(arguments.length===0){this.each(function(){var t=i.findScopeForNode(this);if(t){if(e&&e!==t){throw"The given nodes have multiple different scopes"}e=t}else if(e){throw"Some of the given nodes have scopes and others don't"}});if(e){return e}else{e=i()}}else{var n=arguments[0];if(i.isScope(n)){e=n;t=arguments.length>1?arguments[1]:null}else if(typeof n==="object"){e=i(n);t=null}else{throw"First argument to $.consistent was not an appropriate type: "+typeof n}}this.each(function(){e.$.bind(this,t)});return e}}(jQuery,window);